<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack&amp;&amp;è„šæ‰‹æ¶ç›¸å…³åˆ†äº« | ç‹å‡¯çš„åšå®¢</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" href="./public/images/photo.jpg">
    <link rel="manifest" href="./public/images/photo.jpg">
    <link rel="apple-touch-icon" href="./public/images/photo.jpg">
    <meta name="description" content="æˆ‘çš„ä¸ªäººç½‘ç«™">
    <meta http-quiv="pragma" cotent="no-cache">
    <meta http-quiv="pragma" cotent="no-cache,must-revalidate">
    <meta http-quiv="expires" cotent="0">
    <link rel="preload" href="/assets/css/0.styles.046c06c6.css" as="style"><link rel="preload" href="/assets/js/app.74bcc7fa.js" as="script"><link rel="preload" href="/assets/js/2.57345efc.js" as="script"><link rel="preload" href="/assets/js/10.f361683f.js" as="script"><link rel="prefetch" href="/assets/js/11.a23f8979.js"><link rel="prefetch" href="/assets/js/3.c820e31a.js"><link rel="prefetch" href="/assets/js/4.793a2546.js"><link rel="prefetch" href="/assets/js/5.2bc6bed6.js"><link rel="prefetch" href="/assets/js/6.002e035a.js"><link rel="prefetch" href="/assets/js/7.6c78e50d.js"><link rel="prefetch" href="/assets/js/8.b50b2f0f.js"><link rel="prefetch" href="/assets/js/9.dcd93b3d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.046c06c6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">ç‹å‡¯çš„åšå®¢</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/accumulate/" class="nav-link router-link-active">
  å‰ç«¯åŸºç¡€
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  ç»„ä»¶åº“
</a></div><div class="nav-item"><a href="https://github.com/dreamkai/personal_Blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/accumulate/" class="nav-link router-link-active">
  å‰ç«¯åŸºç¡€
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  ç»„ä»¶åº“
</a></div><div class="nav-item"><a href="https://github.com/dreamkai/personal_Blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/accumulate/" aria-current="page" class="sidebar-link">JavaScript</a></li><li><a href="/accumulate/guide.html" class="sidebar-link">ä½¿ç”¨ VuePress æ­å»ºä¸ªäººåšå®¢</a></li><li><a href="/accumulate/webpack.html" aria-current="page" class="active sidebar-link">webpack&amp;&amp;è„šæ‰‹æ¶ç›¸å…³åˆ†äº«</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#ä½¿ç”¨require-contextå®ç°å‰ç«¯å·¥ç¨‹è‡ªåŠ¨åŒ–" class="sidebar-link">ä½¿ç”¨require.contextå®ç°å‰ç«¯å·¥ç¨‹è‡ªåŠ¨åŒ–</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_1-ä»‹ç»" class="sidebar-link">1. ä»‹ç»</a></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_2-ä½¿ç”¨åœºæ™¯" class="sidebar-link">2. ä½¿ç”¨åœºæ™¯</a></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_3-åˆ†ærequire-context" class="sidebar-link">3. åˆ†ærequire.context</a></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_4-å›¾ç‰‡å¼•å…¥" class="sidebar-link">4. å›¾ç‰‡å¼•å…¥</a></li></ul></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#webpack-å­¦ä¹ " class="sidebar-link">webpack å­¦ä¹ </a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_1-å®‰è£…" class="sidebar-link">1.å®‰è£…</a></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_2-æŒ‡å®šæ‰“åŒ…å…¥å£å’Œå‡ºå£" class="sidebar-link">2.æŒ‡å®šæ‰“åŒ…å…¥å£å’Œå‡ºå£</a></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_3-ä½¿ç”¨loader" class="sidebar-link">3.ä½¿ç”¨loader</a></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_4-ä½¿ç”¨æ’ä»¶plugin" class="sidebar-link">4.ä½¿ç”¨æ’ä»¶plugin</a></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_5-é…ç½®webpack-dev-server" class="sidebar-link">5.é…ç½®webpack-dev-server</a></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_6-æ”¯æŒcss" class="sidebar-link">6. æ”¯æŒcss</a></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_7-æ”¯æŒå›¾ç‰‡" class="sidebar-link">7.æ”¯æŒå›¾ç‰‡</a></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_8-æ”¯æŒjs" class="sidebar-link">8.æ”¯æŒjs</a></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_9-eslintä»£ç æ ¡éªŒ" class="sidebar-link">9. ESlintä»£ç æ ¡éªŒ</a></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_10-sourcemapä»£ç è°ƒè¯•" class="sidebar-link">10. sourcemapä»£ç è°ƒè¯•</a></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_11-æ‰“åŒ…ç¬¬ä¸‰æ–¹ç±»åº“" class="sidebar-link">11 æ‰“åŒ…ç¬¬ä¸‰æ–¹ç±»åº“</a></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_12-å¼€å‘ç¯å¢ƒå’Œçº¿ä¸Šç¯å¢ƒé…ç½®" class="sidebar-link">12.å¼€å‘ç¯å¢ƒå’Œçº¿ä¸Šç¯å¢ƒé…ç½®</a></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_13-é…ç½®å¤šå…¥å£" class="sidebar-link">13. é…ç½®å¤šå…¥å£</a></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_14-hash" class="sidebar-link">14.hash</a></li></ul></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#webpack-åº•å±‚åŸç†" class="sidebar-link">webpack åº•å±‚åŸç†</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_1-webpackåŒæ­¥æ‰“åŒ…æ–‡ä»¶åˆ†æ" class="sidebar-link">1. webpackåŒæ­¥æ‰“åŒ…æ–‡ä»¶åˆ†æ</a></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_2-webpackæ¨¡å—çš„å…¼å®¹å¤„ç†" class="sidebar-link">2. webpackæ¨¡å—çš„å…¼å®¹å¤„ç†</a></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_3-astæŠ½è±¡è¯­æ³•æ ‘" class="sidebar-link">3. ASTæŠ½è±¡è¯­æ³•æ ‘</a></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_4-å®ç°ç®­å¤´å‡½æ•°è½¬æ¢" class="sidebar-link">4.å®ç°ç®­å¤´å‡½æ•°è½¬æ¢</a></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_5-webpack-å·¥ä½œæµ" class="sidebar-link">5.webpack å·¥ä½œæµ</a></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_6-loader-runer" class="sidebar-link">6.loader-runer</a></li><li class="sidebar-sub-header"><a href="/accumulate/webpack.html#_7-babel-loader" class="sidebar-link">7. babel-loader</a></li></ul></li></ul></li><li><a href="/accumulate/JavaScript.html" class="sidebar-link">jsé«˜çº§ç¨‹åºè®¾è®¡</a></li><li><a href="/accumulate/interview.html" class="sidebar-link">å‰ç«¯é¢è¯•é¢˜</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="ä½¿ç”¨require-contextå®ç°å‰ç«¯å·¥ç¨‹è‡ªåŠ¨åŒ–"><a href="#ä½¿ç”¨require-contextå®ç°å‰ç«¯å·¥ç¨‹è‡ªåŠ¨åŒ–" class="header-anchor">#</a> ä½¿ç”¨require.contextå®ç°å‰ç«¯å·¥ç¨‹è‡ªåŠ¨åŒ–</h2> <h3 id="_1-ä»‹ç»"><a href="#_1-ä»‹ç»" class="header-anchor">#</a> 1. ä»‹ç»</h3> <p>ä¸€ä¸ªwebpackçš„api,é€šè¿‡æ‰§è¡Œrequire.contextå‡½æ•°è·å–ä¸€ä¸ªç‰¹å®šçš„ä¸Šä¸‹æ–‡,ä¸»è¦ç”¨æ¥å®ç°è‡ªåŠ¨åŒ–å¯¼å…¥æ¨¡å—,åœ¨å‰ç«¯å·¥ç¨‹ä¸­,å¦‚æœé‡åˆ°ä»ä¸€ä¸ªæ–‡ä»¶å¤¹å¼•å…¥å¾ˆå¤šæ¨¡å—çš„æƒ…å†µ,å¯ä»¥ä½¿ç”¨è¿™ä¸ªapi,å®ƒä¼šéå†æ–‡ä»¶å¤¹ä¸­çš„æŒ‡å®šæ–‡ä»¶,ç„¶åè‡ªåŠ¨å¯¼å…¥,ä½¿å¾—ä¸éœ€è¦æ¯æ¬¡æ˜¾å¼çš„è°ƒç”¨importå¯¼å…¥æ¨¡å—</p> <h3 id="_2-ä½¿ç”¨åœºæ™¯"><a href="#_2-ä½¿ç”¨åœºæ™¯" class="header-anchor">#</a> 2. ä½¿ç”¨åœºæ™¯</h3> <p>æ—¥å¸¸æƒ…å†µä¸‹,æˆ‘ä»¬ä½¿ç”¨æœ€å¤šçš„åˆ™æ˜¯åœ¨vuexå¤§å‹é¡¹ç›®çš„moduleç®¡ç†ä¸Šé¢</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">'vuex'</span>
<span class="token keyword">import</span> getters <span class="token keyword">from</span> <span class="token string">'./getters'</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span>


<span class="token keyword">const</span> modulesFiles <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'./modules'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex">/\.js$/</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> modules <span class="token operator">=</span> modulesFiles<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">modules<span class="token punctuation">,</span> modulePath</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> moduleName <span class="token operator">=</span> modulePath<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/^\.\/(.*)\.\w+$/</span><span class="token punctuation">,</span> <span class="token string">'$1'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token function">modulesFiles</span><span class="token punctuation">(</span>modulePath<span class="token punctuation">)</span>
  modules<span class="token punctuation">[</span>moduleName<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">.</span>default
  <span class="token keyword">return</span> modules
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  modules<span class="token punctuation">,</span>
  getters
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> store

</code></pre></div><p>è®©æˆ‘ä»¬å¯¹æ¯”ä¸€ä¸‹,æ­£å¸¸æƒ…å†µä¸‹,æˆ‘ä»¬ä¸ç”¨å·¥ç¨‹åŒ–è¯¥æ€ä¹ˆåš</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">'vuex'</span>
<span class="token keyword">import</span> errorLog <span class="token keyword">from</span> <span class="token string">'./modules/errorLog'</span>
<span class="token keyword">import</span> permission <span class="token keyword">from</span> <span class="token string">'./modules/permission'</span>
<span class="token keyword">import</span> user <span class="token keyword">from</span> <span class="token string">'./modules/user'</span>
<span class="token keyword">import</span> app <span class="token keyword">from</span> <span class="token string">'./modules/app'</span>
<span class="token keyword">import</span> tagsView <span class="token keyword">from</span> <span class="token string">'./modules/tagsView'</span>
<span class="token keyword">import</span> activity <span class="token keyword">from</span> <span class="token string">'./modules/activity'</span>
<span class="token keyword">import</span> cms <span class="token keyword">from</span> <span class="token string">'./modules/cms'</span>
<span class="token keyword">import</span> dataCenter <span class="token keyword">from</span> <span class="token string">'./modules/dataCenter'</span>
<span class="token keyword">import</span> enter <span class="token keyword">from</span> <span class="token string">'./modules/enter'</span>
<span class="token keyword">import</span> productCenter <span class="token keyword">from</span> <span class="token string">'./modules/productCenter'</span>
<span class="token keyword">import</span> role <span class="token keyword">from</span> <span class="token string">'./modules/role'</span>
<span class="token keyword">import</span> onlineShopInventory <span class="token keyword">from</span> <span class="token string">'./modules/onlineShopInventory'</span>
<span class="token keyword">import</span> notice <span class="token keyword">from</span> <span class="token string">'./modules/notice'</span>

<span class="token keyword">import</span> rfm <span class="token keyword">from</span> <span class="token string">'./modules/rfmShop'</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  modules<span class="token operator">:</span> <span class="token punctuation">{</span>
    app<span class="token punctuation">,</span>
    errorLog<span class="token punctuation">,</span>
    permission<span class="token punctuation">,</span>
    user<span class="token punctuation">,</span>
    tagsView<span class="token punctuation">,</span>
    activity<span class="token punctuation">,</span>
    cms<span class="token punctuation">,</span>
    dataCenter<span class="token punctuation">,</span>
    enter<span class="token punctuation">,</span>
    productCenter<span class="token punctuation">,</span>
    role<span class="token punctuation">,</span>
    onlineShopInventory<span class="token punctuation">,</span>
    notice
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  getters
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> store
</code></pre></div><p>æ˜¯ä¸æ˜¯æ„Ÿè§‰åˆè‡­åˆé•¿,æˆ‘ä»¬æ¯æ¬¡éƒ½éœ€è¦æ‰‹åŠ¨å¼•å…¥,ä¸€æ—¦åæœŸæ›´æ”¹æ–‡ä»¶ä¹‹å,è¿˜ä¼šå‡ºç°æŠ¥é”™çš„é—®é¢˜</p> <h3 id="_3-åˆ†ærequire-context"><a href="#_3-åˆ†ærequire-context" class="header-anchor">#</a> 3. åˆ†ærequire.context</h3> <ol><li>directory {String} -è¯»å–æ–‡ä»¶çš„è·¯å¾„</li> <li>useSubdirectories {Boolean} -æ˜¯å¦éå†æ–‡ä»¶çš„å­ç›®å½•</li> <li>regExp {RegExp} -åŒ¹é…æ–‡ä»¶çš„æ­£åˆ™</li></ol> <p><strong>è¯­æ³•: require.context(directory, useSubdirectories = false, regExp = /^.//);</strong></p> <div class="custom-block tip"><p class="custom-block-title">æç¤º</p> <p>ğŸ˜ƒ å½“ç„¶æˆ‘ä»¬ä¸ä»…åœ¨vuexå’Œrouterç­‰é¡¹ç›®ä¸­ä½¿ç”¨å‰ç«¯å·¥ç¨‹åŒ–,å›¾ç‰‡çš„å¼•å…¥ä¹ŸåŒæ ·å—ç”¨</p></div> <h3 id="_4-å›¾ç‰‡å¼•å…¥"><a href="#_4-å›¾ç‰‡å¼•å…¥" class="header-anchor">#</a> 4. å›¾ç‰‡å¼•å…¥</h3> <p>å¸¸è§„æƒ…å†µä¸‹,æˆ‘ä»¬é¡¹ç›®æ–‡ä»¶htmlçš„å›¾ç‰‡æ ‡ç­¾å¼•å…¥æ–‡ä»¶ä¼šæ˜¯è¿™æ ·çš„:</p> <div class="language-html extra-class"><pre class="language-html"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../assets/logo.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>ä½†æ˜¯è¿™ç§å¸¦æ¥çš„é—®é¢˜å°±æ˜¯åæœŸæˆ‘ä»¬åœ¨æ›´æ¢å›¾ç‰‡æ–‡ä»¶å¤¹å’Œå›¾ç‰‡ä½ç½®çš„æ—¶å€™,ä¹Ÿéœ€è¦æ‰‹åŠ¨ä¿®æ”¹,è¿™å°±æ˜¾å¾—å¾ˆlowäº†ğŸ‘</p> <p>äºæ˜¯æˆ‘ä»¬å¯ä»¥åœ¨webpacké…ç½®,é»˜è®¤ç”¨@è®¿é—®srcæ–‡ä»¶ä¸‹çš„æ–‡ä»¶,è¿™æ ·æˆ‘ä»¬åªè¦ä¿è¯æˆ‘ä»¬è®¿é—®çš„å›¾ç‰‡åœ¨srcä¸‹å°±å¯ä»¥äº†</p> <div class="language-html extra-class"><pre class="language-html"><code>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@/assets/logo.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>ä½†æ˜¯é—®é¢˜åˆæ¥äº†,æˆ‘æ–°å»ºçš„å›¾ç‰‡æ–‡ä»¶å¤¹åœ¨srcä¸‹,ä¸åœ¨åŸç›®å½•ä¸‹,æˆ‘æ˜¯ä¸æ˜¯åˆéœ€è¦æ›´æ”¹ä¸€ä¸‹å‘¢,è€Œä¸”å¤±å»äº†æ™ºèƒ½æé†’,è¿˜éœ€è¦æ‰‹åŠ¨å†™è·¯å¾„,æ— ç–‘è®©æˆ‘ä»¬å¾ˆä¸çˆ½
äºæ˜¯æˆ‘ä»¬åˆ©ç”¨äº†æ¨¡å—åŒ–çš„æ€æƒ³è§£å†³äº†è¿™ä¸ªé—®é¢˜,åˆ©ç”¨requireå¯¼å…¥</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
   bg_top<span class="token operator">:</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/assets/topshow.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
   pro_msg<span class="token operator">:</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/assets/product_msg.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   pro_msg<span class="token operator">:</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/assets/product_msg.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   pro_black<span class="token operator">:</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/assets/black.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   pro_full<span class="token operator">:</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/assets/full.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   pro_progress<span class="token operator">:</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/assets/progress.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   pro_source<span class="token operator">:</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/assets/product_source.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   pro_1<span class="token operator">:</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/assets/img_1.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   pro_2<span class="token operator">:</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/assets/img_2.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   pro_3<span class="token operator">:</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/assets/img_3.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   pro_4<span class="token operator">:</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/assets/img_4.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   pro_5<span class="token operator">:</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/assets/img_5.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   pro_report<span class="token operator">:</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/assets/report.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   pro_last<span class="token operator">:</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/assets/last.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
   pro_step<span class="token operator">:</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/assets/step.png'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æŒ‚è½½åˆ°vueä¸­</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Source <span class="token keyword">from</span> <span class="token string">'@/utils/source'</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$source <span class="token operator">=</span> Source
</code></pre></div><p>é¡µé¢ä½¿ç”¨</p> <div class="language-html extra-class"><pre class="language-html"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$source.bg_top<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>æ­¤åˆ»æˆ‘åªæƒ³è¯´ä¸€å¥,åˆæ›´æœ‰é€¼æ ¼äº†,ä¸å¯¹ç­‰ç­‰,æˆ‘æ„Ÿè§‰ä¹Ÿæ²¡æœ‰å¥½ç”¨åˆ°å“ªå»å•Š,è¿˜è®©æˆ‘ä»¬å¤šå†™äº†ä»£ç ,ä¹Ÿæ²¡æœ‰è§£å†³é—®é¢˜,ä¸ç¬¦åˆç¨‹åºå‘˜çš„æ°”è´¨ğŸ˜µ</p> <p><strong>äºæ˜¯å‰ç«¯å·¥ç¨‹åŒ–å®Œç¾çš„è§£å†³äº†è¿™ä¸ªé—®é¢˜</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> source <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">let</span> requireContext <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'../assets/.'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token regex">/\.(?:jpg|gif|png)$/</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>requireContext<span class="token punctuation">)</span>
<span class="token comment">// requireContext.keys() è¿”å›åŒ¹é…æˆåŠŸæ¨¡å—çš„åå­—ç»„æˆçš„æ•°ç»„</span>
requireContext<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// é€šè¿‡ requireContext(key)å¯¼å‡ºæ–‡ä»¶å†…å®¹</span>
  <span class="token keyword">const</span> mod <span class="token operator">=</span> <span class="token function">requireContext</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
  source<span class="token punctuation">[</span>key<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/(?&lt;=.\/).*?(?=.jpg|.gif|.png)/</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> mod<span class="token punctuation">.</span>__esModule <span class="token operator">&amp;&amp;</span> mod<span class="token punctuation">.</span>default <span class="token operator">?</span> mod<span class="token punctuation">.</span>default <span class="token operator">:</span> mod
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
  <span class="token operator">...</span>source
 <span class="token punctuation">}</span>
</code></pre></div><p>æ­¤æ—¶åœ¨æ§åˆ¶å°</p> <p><img src="/images/webpack.png" alt=""></p> <p>å…¨å±€å¯ä»¥ç›´æ¥ä½¿ç”¨,è€Œä¸”æˆ‘ä»¬åæœŸå¦‚æœéœ€è¦æ›´æ”¹æ–‡ä»¶å¤¹,åªéœ€è¦ç»Ÿä¸€é…ç½®å°±è¡Œ,ä¹Ÿä¸ç”¨æ‹…å¿ƒæ–‡ä»¶è·¯å¾„,ç”¨èµ·æ¥æ–¹ä¾¿å¾ˆå¤š</p> <div class="language-html extra-class"><pre class="language-html"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$source.logo<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">æ³¨æ„</p> <p>ğŸ˜ æ—¥å¸¸æ­£åˆ™åŒ¹é…ä¸€å®šè¦å¤„ç†å¥½,å¦åˆ™å…¨å±€å›¾ç‰‡å´©ç›˜,åˆ°æ—¶å€™å°±çˆ½æ­ªæ­ªå’¯</p></div> <h2 id="webpack-å­¦ä¹ "><a href="#webpack-å­¦ä¹ " class="header-anchor">#</a> webpack å­¦ä¹ </h2> <h3 id="_1-å®‰è£…"><a href="#_1-å®‰è£…" class="header-anchor">#</a> 1.å®‰è£…</h3> <p>åˆå§‹åŒ–:npm init</p> <div class="language-js extra-class"><pre class="language-js"><code> npm install webpack webpack<span class="token operator">-</span>cli <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><h3 id="_2-æŒ‡å®šæ‰“åŒ…å…¥å£å’Œå‡ºå£"><a href="#_2-æŒ‡å®šæ‰“åŒ…å…¥å£å’Œå‡ºå£" class="header-anchor">#</a> 2.æŒ‡å®šæ‰“åŒ…å…¥å£å’Œå‡ºå£</h3> <h4 id="_2-1-åŒçº§ä¸‹åˆ›å»ºwebpack-config-js"><a href="#_2-1-åŒçº§ä¸‹åˆ›å»ºwebpack-config-js" class="header-anchor">#</a> 2.1 åŒçº§ä¸‹åˆ›å»ºwebpack.config.js</h4> <ul><li><font color="red">entry</font>:æŒ‡å®šæ‰“åŒ…æ–‡ä»¶çš„å…¥å£</li> <li><font color="red">output</font>:æŒ‡å®šæ‰“åŒ…ç”Ÿæˆæ–‡ä»¶çš„å‡ºå£</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">const</span> <span class="token punctuation">{</span> resolve <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
      mode<span class="token operator">:</span><span class="token string">'development'</span> <span class="token comment">//å¯ä»¥å®ç°æ‰“åŒ…ä»£ç ä¸å‹ç¼©</span>
      entry<span class="token operator">:</span><span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
      output<span class="token operator">:</span><span class="token punctuation">{</span>
          path<span class="token operator">:</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">//è¾“å‡ºæ–‡ä»¶å¤¹çš„ç»å¯¹è·¯å¾„</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_2-2-path-publicpath-contentbaseåŒºåˆ«"><a href="#_2-2-path-publicpath-contentbaseåŒºåˆ«" class="header-anchor">#</a> 2.2 path,publicPath,contentBaseåŒºåˆ«</h4> <table><thead><tr><th style="text-align:center;">ç±»åˆ«</th> <th style="text-align:center;">é…ç½®åç§°</th> <th style="text-align:center;">æè¿°</th></tr></thead> <tbody><tr><td style="text-align:center;">output</td> <td style="text-align:center;">path</td> <td style="text-align:center;">æŒ‡å®šè¾“å‡ºåˆ°ç¡¬ç›˜ä¸­çš„ç›®å½•</td></tr> <tr><td style="text-align:center;">output</td> <td style="text-align:center;">publicPath</td> <td style="text-align:center;">è¡¨ç¤ºçš„æ˜¯æ‰“åŒ…ç”Ÿæˆçš„index.htmlæ–‡ä»¶é‡Œé¢å¼•å…¥èµ„æºçš„å‰ç¼€</td></tr> <tr><td style="text-align:center;">devServer</td> <td style="text-align:center;">publicPath</td> <td style="text-align:center;">ä¸»è¦ç”¨äºå¼€å‘ç¯å¢ƒè®¿ é—®çš„è·¯å¾„, è¡¨ç¤ºçš„æ˜¯æ‰“åŒ…ç”Ÿæˆé™æ€æ–‡ä»¶æ‰€åœ¨çš„ä½ç½®(è‹¥æ˜¯devServeré‡Œé¢çš„publicPathæ²¡æœ‰è®¾ç½®,åˆ™ä¼šè®¤ä¸ºæ˜¯outputé‡Œé¢è®¾ç½®çš„publicPathçš„å€¼),è¦ä¿è¯å’Œoutput publicPathä¸€æ ·</td></tr> <tr><td style="text-align:center;">devServer</td> <td style="text-align:center;">contentBase</td> <td style="text-align:center;">ç”¨äºé…ç½®æä¾›é¢å¤–é™æ€æ–‡ä»¶å†…å®¹çš„ç›®å½•(ä¸éœ€è¦æ‰“åŒ…çš„å†…å®¹,æ¯”å¦‚å›¾ç‰‡)</td></tr></tbody></table> <h3 id="_3-ä½¿ç”¨loader"><a href="#_3-ä½¿ç”¨loader" class="header-anchor">#</a> 3.ä½¿ç”¨loader</h3> <ul><li>webpackåªèƒ½ç†è§£jså’Œjsonæ–‡ä»¶</li> <li>loaderè®©webpackèƒ½å¤„ç†å…¶ä»–ç±»å‹çš„æ–‡ä»¶,å¹¶å°†ä»–ä»¬è½¬æ¢æˆæœ‰æ•ˆçš„æ¨¡å—,ä»¥ä¾›ç¨‹åºä½¿ç”¨,ä»¥åŠè¢«æ·»åŠ åˆ°ä¾èµ–å›¾ä¸­</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token operator">:</span><span class="token punctuation">{</span>
  rules<span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>test<span class="token operator">:</span><span class="token regex">/.txt$/</span><span class="token punctuation">,</span>use<span class="token operator">:</span>'raw<span class="token operator">-</span>loader<span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_4-ä½¿ç”¨æ’ä»¶plugin"><a href="#_4-ä½¿ç”¨æ’ä»¶plugin" class="header-anchor">#</a> 4.ä½¿ç”¨æ’ä»¶plugin</h3> <h4 id="_4-1-å®‰è£…"><a href="#_4-1-å®‰è£…" class="header-anchor">#</a> 4.1 å®‰è£…</h4> <div class="language-js extra-class"><pre class="language-js"><code> npm install html<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin  <span class="token operator">-</span><span class="token constant">D</span>

</code></pre></div><h4 id="_4-2-ä½¿ç”¨"><a href="#_4-2-ä½¿ç”¨" class="header-anchor">#</a> 4.2 ä½¿ç”¨</h4> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>

 plugins<span class="token operator">:</span><span class="token punctuation">[</span>
   <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
     template<span class="token operator">:</span><span class="token string">'./src/index.html'</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token punctuation">]</span>

</code></pre></div><h3 id="_5-é…ç½®webpack-dev-server"><a href="#_5-é…ç½®webpack-dev-server" class="header-anchor">#</a> 5.é…ç½®webpack-dev-server</h3> <h4 id="_5-1-å®‰è£…"><a href="#_5-1-å®‰è£…" class="header-anchor">#</a> 5.1 å®‰è£…</h4> <div class="language-js extra-class"><pre class="language-js"><code> npm install webpack<span class="token operator">-</span>dev<span class="token operator">-</span>server  <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><h4 id="_5-2-ä½¿ç”¨"><a href="#_5-2-ä½¿ç”¨" class="header-anchor">#</a> 5.2 ä½¿ç”¨</h4> <ul><li>devServerä¼šå¯åŠ¨ä¸€ä¸ªhttpæœåŠ¡å™¨,æŠŠä¸€ä¸ªæ–‡ä»¶å¤¹ä½œä¸ºé™æ€ç›®å½•</li> <li>ä¸ºäº†æé«˜æ€§èƒ½,ä½¿ç”¨çš„å†…å­˜æ–‡ä»¶ç³»ç»Ÿ</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>   devServer<span class="token operator">:</span><span class="token punctuation">{</span>
      contentBase<span class="token operator">:</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">//outputä¼˜å…ˆçº§æ›´é«˜å†…å®¹è·¯å¾„,å¯ä»¥ä¸éœ€è¦</span>
      writeToDisk<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//æ­¤é€‰é¡¹å¯ä»¥ç”Ÿæˆä¸€ä»½æ‰“åŒ…æ–‡ä»¶å†™å…¥ç¡¬ç›˜é‡Œé¢</span>
      port<span class="token operator">:</span><span class="token number">8080</span><span class="token punctuation">,</span>
      open<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨</span>
      compress<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token comment">//æ˜¯å¦å¼€å¯è‡ªåŠ¨å‹ç¼©</span>
      publicPath<span class="token operator">:</span><span class="token string">'/'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><ul><li>publicPathå¯ä»¥ä¸éœ€è¦,é»˜è®¤æ˜¯/</li> <li>contentBaseæ­£å¸¸ä¸éœ€è¦,ä¼šé¦–å…ˆè®¿é—®output</li></ul> <h3 id="_6-æ”¯æŒcss"><a href="#_6-æ”¯æŒcss" class="header-anchor">#</a> 6. æ”¯æŒcss</h3> <h4 id="_6-1-å®‰è£…"><a href="#_6-1-å®‰è£…" class="header-anchor">#</a> 6.1 å®‰è£…</h4> <div class="language-js extra-class"><pre class="language-js"><code>npm install css<span class="token operator">-</span>loader style<span class="token operator">-</span>loader  <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><h4 id="_6-2-ä½¿ç”¨æ¨¡å—"><a href="#_6-2-ä½¿ç”¨æ¨¡å—" class="header-anchor">#</a> 6.2 ä½¿ç”¨æ¨¡å—</h4> <ul><li>css-loaderç”¨äºå¤„ç†importç­‰è¯­æ³•æ–‡ä»¶å¼•å…¥</li> <li>style-loaderç”¨äºæŠŠstyleæŸ¥åˆ°html,headçš„styleé‡Œé¢</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token operator">:</span><span class="token punctuation">{</span>
  rules<span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>test<span class="token operator">:</span><span class="token regex">/\.css$/</span><span class="token punctuation">,</span>use<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span><span class="token string">'css-loader'</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre></div><h4 id="_6-3-æ”¯æŒsasså’Œless"><a href="#_6-3-æ”¯æŒsasså’Œless" class="header-anchor">#</a> 6.3 æ”¯æŒsasså’Œless</h4> <div class="language-js extra-class"><pre class="language-js"><code>npm install less less<span class="token operator">-</span>loader node<span class="token operator">-</span>sass sass<span class="token operator">-</span>loader  <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><p>ä½¿ç”¨</p> <ul><li>less-loaderç”¨äºå¤„ç†æŠŠlessè½¬æˆcss</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token operator">:</span><span class="token punctuation">{</span>
  rules<span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>test<span class="token operator">:</span><span class="token regex">/\.less$/</span><span class="token punctuation">,</span>use<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span><span class="token string">'css-loader'</span><span class="token punctuation">,</span>'less<span class="token operator">-</span>loader<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>test<span class="token operator">:</span><span class="token regex">/\.scss$/</span><span class="token punctuation">,</span>use<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span><span class="token string">'css-loader'</span><span class="token punctuation">,</span>'sass<span class="token operator">-</span>loader<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="_7-æ”¯æŒå›¾ç‰‡"><a href="#_7-æ”¯æŒå›¾ç‰‡" class="header-anchor">#</a> 7.æ”¯æŒå›¾ç‰‡</h3> <ul><li>åœ¨webpackä¸­å¼•å…¥å›¾ç‰‡
<ul><li>é€šè¿‡importæˆ–è€…requireå¼•å…¥å›¾ç‰‡</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">const</span> logo <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./logo.png'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  img<span class="token punctuation">.</span>src <span class="token operator">=</span> logo <span class="token comment">//esModule:true;é‚£logo.defaultæ‰èƒ½è·å–å›¾ç‰‡</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span>
</code></pre></div><ul><li>é€šè¿‡é™æ€æ–‡ä»¶ç›®å½•,é€šè¿‡htmlå¼•å…¥,éœ€è¦é…ç½®devServer.contentBase,ä¸ç„¶åªèƒ½è¯»å–æ‰“åŒ…åçš„æ–‡ä»¶äº†  resolve(__dirname,'static')</li> <li>åœ¨cssé€šè¿‡urlå¼•å…¥å›¾ç‰‡.css-loaderè¿›è¡Œè§£æå¤„ç†</li></ul></li></ul> <h4 id="_7-1-å®‰è£…"><a href="#_7-1-å®‰è£…" class="header-anchor">#</a> 7.1 å®‰è£…</h4> <div class="language-js extra-class"><pre class="language-js"><code>npm install file<span class="token operator">-</span>loader url<span class="token operator">-</span>loader html<span class="token operator">-</span>loader <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><h4 id="_7-2-ä½¿ç”¨"><a href="#_7-2-ä½¿ç”¨" class="header-anchor">#</a> 7.2 ä½¿ç”¨</h4> <div class="language-js extra-class"><pre class="language-js"><code>
module<span class="token operator">:</span><span class="token punctuation">{</span>
  rules<span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>test<span class="token operator">:</span><span class="token regex">/\.(jpg|png|bmp)$/</span><span class="token punctuation">,</span>use<span class="token operator">:</span><span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        loader<span class="token operator">:</span><span class="token string">'file-loader'</span><span class="token punctuation">,</span>
        options<span class="token operator">:</span><span class="token punctuation">{</span>
          name<span class="token operator">:</span><span class="token string">'[hash:10].[ext]'</span><span class="token comment">//å“ˆå¸Œå–10ä½,ä¿ç•™æ‹“å±•å</span>
          esModule<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token comment">//ä¸éœ€è¦åŒ…è£…æˆes6æ¨¡å—</span>
          limit<span class="token operator">:</span><span class="token number">32</span><span class="token operator">*</span><span class="token number">1024</span> <span class="token comment">//å¦‚æœå›¾ç‰‡å°äºlimit,å°äº8kçš„è¯å°±ä¼šè½¬æˆbase64ä½å†…åµŒåˆ°htmlä¸­,å¦åˆ™è¡Œä¸ºå’Œfile-loaderä¸€æ ·</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
   
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">æç¤º</p> <p>url-loaderæ˜¯å¯¹file-loaderå¢å¼º,å¤šäº†ä¸€ä¸ªé€‰é¡¹limit<br>
url-loaderå†…éƒ¨ä¾èµ–file-loader,æ‰€ä»¥ä¼šå¸®ä½ å®‰è£…<br>
åˆ¤æ–­å›¾ç‰‡æ˜¯ä¸æ˜¯å¤§äºlimit,å¦‚æœå¤§äºçš„è¯å°±ä¼šæŠŠå·¥ä½œäº¤ç»™file-loaderå¤„ç†,å¦åˆ™,å°±è½¬æˆbase64è‡ªå·±å¤„ç†</p></div> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token operator">:</span><span class="token punctuation">{</span>
  rules<span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>test<span class="token operator">:</span><span class="token regex">/\.(jpg|png|bmp)$/</span><span class="token punctuation">,</span>use<span class="token operator">:</span><span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        loader<span class="token operator">:</span><span class="token string">'url-loader'</span><span class="token punctuation">,</span>
        option<span class="token operator">:</span><span class="token punctuation">{</span>
          name<span class="token operator">:</span><span class="token string">'[hash:10].[ext]'</span><span class="token comment">//å“ˆå¸Œå–10ä½,ä¿ç•™æ‹“å±•å</span>
          esModule<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token comment">//ä¸éœ€è¦åŒ…è£…æˆes6æ¨¡å—</span>
          limit<span class="token operator">:</span>
          
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
   
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-æ”¯æŒjs"><a href="#_8-æ”¯æŒjs" class="header-anchor">#</a> 8.æ”¯æŒjs</h3> <ul><li>babel-loaderä½¿ç”¨Babelå’Œwebpackè½¬ä¹‰jsæ–‡ä»¶</li> <li><font color="blue">@babel/@babel/core</font>æ˜¯Babelç¼–è¯‘çš„æ ¸å¿ƒåŒ…,è¿˜æœ‰æ ¸å¿ƒAPI,æ¯”å¦‚transform,parse,babel/codeæœ¬èº«ç”Ÿäº§è¯­æ³•æ ‘,éå†è¯­æ³•æ ‘,ç”Ÿæˆæ–°ä»£ç ,ä¸è´Ÿè´£è½¬æ¢è¯­æ³•æ ‘,</li> <li><font color="blue">babel-types</font>è´Ÿè´£æ„é€ ,éªŒè¯ä»¥åŠå˜æ¢ASTèŠ‚ç‚¹çš„æ–¹å¼,å¯¹ç¼–å†™ASTé€»è¾‘æœ‰æ•ˆ</li> <li><font color="blue">babel-template</font>å¯ä»¥å°†æ™®é€šå­—ç¬¦ä¸²è½¬æˆAST,æä¾›æ›´ä¾¿æ·å®ç”¨</li> <li><font color="blue">babel-traverse</font>ç”¨äºASTéå†,ç»´æŠ¤æ•´æ£µæ ‘çŠ¶æ€,è´Ÿè´£æ›¿æ¢,ç§»é™¤å’Œæ·»åŠ èŠ‚ç‚¹</li> <li><font color="blue">@babel/@babel/present-env</font>ä¸ºæ¯ä¸€ä¸ªç¯å¢ƒçš„é¢„è®¾,åªèƒ½è½¬æ¢jsè¯­æ³•</li> <li><font color="blue">@babel/plugin-proposal-decorators</font>æŠŠç±»å’Œå¯¹è±¡è£…é¥°å™¨ç¼–è¯‘æˆES5</li> <li><font color="blue">@babel/plugin-proposal-class-properties</font>è½¬æ¢é™æ€ç±»å±æ€§ä»¥åŠä½¿ç”¨å±æ€§åˆå§‹å€¼è¯­æ³•å£°æ˜çš„å±æ€§</li></ul> <h4 id="_8-1-ä½¿ç”¨"><a href="#_8-1-ä½¿ç”¨" class="header-anchor">#</a> 8.1 ä½¿ç”¨</h4> <div class="language-js extra-class"><pre class="language-js"><code> module<span class="token operator">:</span><span class="token punctuation">{</span>
   rules<span class="token operator">:</span><span class="token punctuation">[</span>
     <span class="token punctuation">{</span>test<span class="token operator">:</span><span class="token regex">/\.js$/</span><span class="token punctuation">,</span>use<span class="token operator">:</span><span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        loader<span class="token operator">:</span><span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
        options<span class="token operator">:</span><span class="token punctuation">{</span>
          presets<span class="token operator">:</span><span class="token punctuation">[</span>
             <span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span><span class="token comment">//å¯ä»¥è½¬æ¢jsè¯­æ³•,è½¬æˆä½çº§è¯­æ³•</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
     <span class="token punctuation">]</span><span class="token punctuation">}</span>
   <span class="token punctuation">]</span>
 <span class="token punctuation">}</span>

</code></pre></div><h4 id="_8-2-babel-loader-babel-core-babel-preset-envçš„å…³ç³»"><a href="#_8-2-babel-loader-babel-core-babel-preset-envçš„å…³ç³»" class="header-anchor">#</a> 8.2 babel-loader,babel/core,babel/preset-envçš„å…³ç³»</h4> <ul><li>babel-loaderæ˜¯ä¸€ä¸ªå‡½æ•°
<ul><li>babel-loaderçš„ä½œç”¨æ˜¯è°ƒç”¨babelCore</li> <li>babelCoreæœ¬èº«å€¼æä¾›ä¸€ä¸ªè¿‡ç¨‹ç®¡ç†åŠŸèƒ½,æŠŠæºä»£ç è½¬æ¢æˆæŠ½è±¡è¯­æ³•æ ‘,é€šè¿‡éå†å’Œç”Ÿæˆ,å®ƒæœ¬èº«ä¹Ÿä¸çŸ¥é“,å…·ä½“è¦è½¬æ¢æˆä»€ä¹ˆè¯­æ³•,ä»¥åŠè¯­æ³•å¦‚ä½•è½¬æ¢,è¿™ä¸ªåªæœ‰babel/preset-env</li> <li>é¢„è®¾æ˜¯pluginæ’ä»¶çš„é›†åˆ,é‡Œé¢æœ‰å¾ˆå¤šæ’ä»¶</li></ul></li></ul> <table><thead><tr><th style="text-align:center;">babel</th> <th style="text-align:center;">è¯´æ˜</th></tr></thead> <tbody><tr><td style="text-align:center;">babel-loader</td> <td style="text-align:center;">è´Ÿè´£è°ƒç”¨babelCore</td></tr> <tr><td style="text-align:center;">babel/core</td> <td style="text-align:center;">æŠŠæºä»£ç è½¬æ¢æˆæŠ½è±¡è¯­æ³•æ ‘,é€šè¿‡babel/preset-envå¤„ç†å®Œå,å†ç”¨es5è¯­æ³•æ ‘é‡æ–°ç”Ÿæˆes5è¯­æ³•</td></tr> <tr><td style="text-align:center;">babel/preset-env</td> <td style="text-align:center;">è´Ÿè´£æŠŠes6è½¬æˆes5è¯­æ³•æ ‘</td></tr></tbody></table> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">loader</span><span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> es5 <span class="token operator">=</span> babelCore<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span>
  <span class="token keyword">return</span> es5<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_8-3-è£…é¥°å™¨çš„ä½¿ç”¨"><a href="#_8-3-è£…é¥°å™¨çš„ä½¿ç”¨" class="header-anchor">#</a> 8.3 è£…é¥°å™¨çš„ä½¿ç”¨</h4> <div class="language-js extra-class"><pre class="language-js"><code> module<span class="token operator">:</span><span class="token punctuation">{</span>
   rules<span class="token operator">:</span><span class="token punctuation">[</span>
     <span class="token punctuation">{</span>test<span class="token operator">:</span><span class="token regex">/\.js$/</span><span class="token punctuation">,</span>use<span class="token operator">:</span><span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        loader<span class="token operator">:</span><span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
        options<span class="token operator">:</span><span class="token punctuation">{</span>
          presets<span class="token operator">:</span><span class="token punctuation">[</span>
             <span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span><span class="token comment">//å¯ä»¥è½¬æ¢jsè¯­æ³•,è½¬æˆä½çº§è¯­æ³•</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          plugins<span class="token operator">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">[</span><span class="token string">&quot;@babel/plugin-proposal-class-properties&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span>legacy<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
     <span class="token punctuation">]</span><span class="token punctuation">}</span>
   <span class="token punctuation">]</span>
 <span class="token punctuation">}</span>

</code></pre></div><h4 id="_8-4-babel-polyfillå’Œbabel-runtime"><a href="#_8-4-babel-polyfillå’Œbabel-runtime" class="header-anchor">#</a> 8.4 babel-polyfillå’Œbabel-runtime</h4> <h4 id="_8-4-1-babel-polyfill"><a href="#_8-4-1-babel-polyfill" class="header-anchor">#</a> 8.4.1  babel-polyfill</h4> <ul><li>Babelé»˜è®¤åªèƒ½è½¬æ¢jsè¯­æ³•,è€Œä¸èƒ½è½¬æ¢æ–°çš„API,æ¯”å¦‚Set,Map,Promise,Proxyç­‰å…¨å±€å¯¹è±¡,è¿˜æœ‰å…¨å±€å¯¹è±¡æ–¹æ³•æ¯”å¦‚Object.assignéƒ½ä¸ä¼šè½¬ç </li> <li>babel-polyfillæ˜¯é€šè¿‡å…¨å±€å¯¹è±¡å’Œå†…ç½®å¯¹è±¡çš„prototypeå®ç°çš„,ç¼ºç‚¹æ˜¯å…¨å±€ç©ºé—´æ±¡æŸ“</li> <li>core-js  å…¶å®å°±æ˜¯è…»å­åŒ…,å¯ä»¥è¡¥å……ç¼ºå¤±</li></ul> <p>@babel/@babel/preset-envæœªç¯å¢ƒé¢„è®¾</p> <ul><li>&quot;useBuiltins:&quot;false&quot;,ä¸å¯¹polyfillåšæ“ä½œ,å¦‚æœå¼•å…¥@babel/polyfill,åˆ™å…¨å±€å¼•å…¥</li> <li>&quot;useBuiltins:&quot;entry&quot;,æ ¹æ®é…ç½®æµè§ˆå™¨å…¼å®¹,æ­¤æ—¶éœ€è¦æ‰‹åŠ¨å¼•å…¥ import &quot;core-ks/stable&quot; import &quot;regenerator-runtime/runtime&quot;</li> <li>&quot;useBuiltins:&quot;usage&quot;,å®ç°æŒ‰éœ€åŠ è½½,åŠ¨æ€å¼•å…¥éœ€è¦çš„è¯­æ³•</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> module<span class="token operator">:</span><span class="token punctuation">{</span>
   rules<span class="token operator">:</span><span class="token punctuation">[</span>
     <span class="token punctuation">{</span>test<span class="token operator">:</span><span class="token regex">/\.js$/</span><span class="token punctuation">,</span>use<span class="token operator">:</span><span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        loader<span class="token operator">:</span><span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
        options<span class="token operator">:</span><span class="token punctuation">{</span>
          presets<span class="token operator">:</span><span class="token punctuation">[</span>
            <span class="token punctuation">[</span>
              <span class="token string">&quot;@/babel/preset-env&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
                useBuiltIns<span class="token operator">:</span><span class="token string">'usage'</span><span class="token punctuation">,</span><span class="token comment">//æŒ‰éœ€åŠ è½½polyfill</span>
                corejs<span class="token operator">:</span><span class="token punctuation">{</span>version<span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                 targets<span class="token operator">:</span><span class="token punctuation">[</span>
                 chrome<span class="token operator">:</span><span class="token string">'60'</span><span class="token punctuation">,</span>
                 filefox<span class="token operator">:</span><span class="token string">'60'</span><span class="token punctuation">,</span>
                 ie<span class="token operator">:</span><span class="token string">'9'</span><span class="token punctuation">,</span>
                 <span class="token punctuation">.</span>
                 <span class="token punctuation">.</span>
                 <span class="token punctuation">.</span>
               <span class="token punctuation">]</span> 
              <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
     <span class="token punctuation">]</span><span class="token punctuation">}</span>
   <span class="token punctuation">]</span>
 <span class="token punctuation">}</span>

</code></pre></div><h4 id="_8-4-2-babel-runtime"><a href="#_8-4-2-babel-runtime" class="header-anchor">#</a> 8.4.2  babel-runtime</h4> <ul><li>Babelä¸ºè§£å†³å…¨å±€ç©ºé—´æ±¡æŸ“çš„é—®é¢˜,æä¾›äº†å•ç‹¬çš„åŒ…babel-runtimeç”¨äºç¼–è¯‘æ¨¡å—çš„å·¥å…·å‡½æ•°</li> <li>babel-runtime æ›´åƒæ˜¯æŒ‰éœ€åŠ è½½çš„è¡¨ç°</li> <li>éœ€è¦æ‰‹åŠ¨å¼•å…¥</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>npm install babel<span class="token operator">-</span>runtime <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">import</span> Promise <span class="token keyword">from</span> <span class="token string">&quot;babel-runtime/core-js/promise&quot;</span>
 <span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>

 <span class="token punctuation">}</span><span class="token punctuation">)</span>


</code></pre></div><h4 id="_8-4-3-babel-plugin-transform-runtime"><a href="#_8-4-3-babel-plugin-transform-runtime" class="header-anchor">#</a> 8.4.3  babel-plugin-transform-runtime</h4> <ul><li>å¯ç”¨æ’ä»¶å,Babelå°±ä¼šä½¿ç”¨babel-runtimeå‡½æ•°</li> <li>æ’ä»¶èƒ½è‡ªåŠ¨è½¬æ¢æˆrequireè¯­æ³•,æŒ‡å‘ä¸ºbabel-runtimeçš„åº”ç”¨</li> <li>babel-plugin-transform-plugin åœ¨ä½¿ç”¨apiè‡ªåŠ¨å¼•å…¥import babel-runtimeé‡Œé¢polyfill
<ul><li>å½“æˆ‘ä»¬ä½¿ç”¨async/await ,è‡ªåŠ¨å¼•å…¥babel/runtime/regenerator</li> <li>å½“æˆ‘ä»¬ä½¿ç”¨ES6é™æ€äº‹ä»¶æˆ–è€…å†…ç½®å¯¹è±¡,è‡ªåŠ¨å¼•å…¥babel-runtim/core-js</li> <li>ç§»é™¤å†…é‡Œçœ‹babel helpersæ›¿æ¢ä½¿ç”¨babel-runtime/helpers</li></ul></li></ul> <p>å®‰è£…</p> <div class="language-js extra-class"><pre class="language-js"><code> npm install @babel<span class="token operator">/</span>runtime<span class="token operator">-</span>corejs2 <span class="token operator">-</span><span class="token constant">D</span>

</code></pre></div><p>ä½¿ç”¨</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token operator">:</span><span class="token punctuation">{</span>
  rules<span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      test<span class="token operator">:</span><span class="token regex">/\.js$/</span><span class="token punctuation">,</span>use<span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          loader<span class="token operator">:</span><span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
          options<span class="token operator">:</span><span class="token punctuation">{</span>
            presets<span class="token operator">:</span><span class="token punctuation">[</span>
              <span class="token punctuation">[</span>
                <span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
                  useBuiltIns<span class="token operator">:</span><span class="token string">&quot;usage&quot;</span><span class="token punctuation">,</span>
                  corejs<span class="token operator">:</span><span class="token punctuation">{</span>version<span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">]</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            plugins<span class="token operator">:</span><span class="token punctuation">[</span>
             <span class="token punctuation">[</span>&quot;babel<span class="token operator">-</span>plugin<span class="token operator">-</span>transform<span class="token operator">-</span>runtime'<span class="token punctuation">,</span><span class="token punctuation">{</span>
               corejs<span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span>
               helpers<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//æ˜¯å¦æå–ç±»çš„æ¨¡å—ç»§æ‰¿æ–¹æ³•</span>
               regenerator<span class="token operator">:</span><span class="token boolean">true</span>
             <span class="token punctuation">}</span><span class="token punctuation">]</span>
            <span class="token punctuation">]</span>   
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token operator">:</span><span class="token operator">:</span><span class="token operator">:</span> tip æç¤º

babel<span class="token operator">-</span>runtimeæ›´é€‚åˆåœ¨ç±»åº“å’Œç»„ä»¶ä½¿ç”¨<span class="token punctuation">,</span>è€Œbabel<span class="token operator">-</span>polyfillé€‚åˆä¸šåŠ¡é¡¹ç›®ä½¿ç”¨


<span class="token operator">:</span><span class="token operator">:</span><span class="token operator">:</span>



</code></pre></div><h3 id="_9-eslintä»£ç æ ¡éªŒ"><a href="#_9-eslintä»£ç æ ¡éªŒ" class="header-anchor">#</a> 9. ESlintä»£ç æ ¡éªŒ</h3> <h4 id="_9-1-å®‰è£…"><a href="#_9-1-å®‰è£…" class="header-anchor">#</a> 9.1 å®‰è£…</h4> <div class="language-js extra-class"><pre class="language-js"><code> npm install eslint eslint<span class="token operator">-</span>loader babel<span class="token operator">-</span>eslint <span class="token operator">-</span><span class="token constant">D</span>

</code></pre></div><h4 id="_9-2-ä½¿ç”¨"><a href="#_9-2-ä½¿ç”¨" class="header-anchor">#</a> 9.2 ä½¿ç”¨</h4> <div class="language-js extra-class"><pre class="language-js"><code> module<span class="token operator">:</span><span class="token punctuation">{</span>
   rules<span class="token operator">:</span><span class="token punctuation">[</span>
     <span class="token punctuation">{</span>
       test<span class="token operator">:</span><span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
       use<span class="token operator">:</span><span class="token string">'eslint-loader'</span><span class="token punctuation">,</span>
       enforce<span class="token operator">:</span><span class="token string">'pre'</span><span class="token punctuation">,</span> <span class="token comment">//å¼ºåˆ¶æ‰§è¡Œé¡ºåº</span>
       options<span class="token operator">:</span><span class="token punctuation">{</span>fix<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token comment">//å¼ºåˆ¶ä¿®å¤</span>
       exclude<span class="token operator">:</span><span class="token regex">/node_module/</span> <span class="token comment">//ä¸éœ€è¦æ£€æŸ¥</span>
       include<span class="token operator">:</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span>'src<span class="token punctuation">)</span> <span class="token comment">//åŒ…å«</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">]</span>
 <span class="token punctuation">}</span>
</code></pre></div><h4 id="_9-3-ä½¿ç”¨æ’ä»¶airbnbå¢åŠ æ ¡éªŒé…ç½®"><a href="#_9-3-ä½¿ç”¨æ’ä»¶airbnbå¢åŠ æ ¡éªŒé…ç½®" class="header-anchor">#</a> 9.3 ä½¿ç”¨æ’ä»¶airbnbå¢åŠ æ ¡éªŒé…ç½®</h4> <p>æ–°å»ºæ–‡ä»¶.eslint.js</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  parser<span class="token operator">:</span><span class="token string">&quot;babel-eslint&quot;</span><span class="token punctuation">,</span><span class="token comment">//è§£æå™¨å¸®åŠ©æˆ‘ä»¬æŠŠæºä»£ç è½¬æˆæŠ½è±¡è¯­æ³•æ ‘</span>
  <span class="token keyword">extends</span><span class="token operator">:</span><span class="token string">'airbnb'</span><span class="token punctuation">,</span>
  parserOption<span class="token operator">:</span><span class="token punctuation">{</span>
    sourceType<span class="token operator">:</span><span class="token string">&quot;module&quot;</span><span class="token punctuation">,</span>
    ecmaVersion<span class="token operator">:</span><span class="token number">2015</span>
  <span class="token punctuation">}</span>
  env<span class="token operator">:</span><span class="token punctuation">{</span>
    browser<span class="token operator">:</span><span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  rules<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="_10-sourcemapä»£ç è°ƒè¯•"><a href="#_10-sourcemapä»£ç è°ƒè¯•" class="header-anchor">#</a> 10. sourcemapä»£ç è°ƒè¯•</h3> <ul><li>sourcemapæ˜¯ä¸ºäº†è§£å†³å¼€å‘ä»£ç ä¸å®é™…ä»£ç ä¸ä¸€è‡´å¸®åŠ©æˆ‘ä»¬debugåˆ°åŸå§‹ä»£ç çš„æŠ€æœ¯</li> <li>webpack é€šè¿‡é…ç½®å¯ä»¥ç»™æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆsource mapsæ–‡ä»¶,map æ–‡ä»¶æ˜¯ä¸€ç§å¯¹åº”ç¼–è¯‘æ–‡ä»¶å’Œæºæ–‡ä»¶çš„æ–¹æ³•</li></ul> <table><thead><tr><th style="text-align:center;">ç±»å‹</th> <th style="text-align:center;">å«ä¹‰</th></tr></thead> <tbody><tr><td style="text-align:center;">source-map</td> <td style="text-align:center;">åŸå§‹ä»£ç  æœ€å¥½çš„sourcemapè´¨é‡,æœ‰å®Œæ•´çš„ç»“æœ,å•ç‹¬åœ¨å¤–éƒ¨ç”Ÿæˆå®Œæ•´çš„sourcemapæ–‡ä»¶,å¹¶ä¸”åœ¨ç›®æ ‡æ–‡ä»¶ç®€å†å…³è”,èƒ½æç¤ºé”™è¯¯ä»£ç å’Œå®šä½å‡†ç¡®ä½ç½®,æ„å»ºæ…¢</td></tr> <tr><td style="text-align:center;">inline-source-map</td> <td style="text-align:center;">ä»¥base64æ ¼å¼å†…è”åœ¨æ‰“åŒ…æ–‡ä»¶ä¸­,å†…æ•›æ„å»ºé€Ÿåº¦æ›´å¿«,ä¹Ÿèƒ½æç¤ºé”™è¯¯ä»£ç å’Œå‡†ç¡®ä½ç½®</td></tr> <tr><td style="text-align:center;">eval-source-map</td> <td style="text-align:center;">æ¯ä¸ªæŸå—å•ç‹¬ç”Ÿäº§ä¸€ä¸ªå•ç‹¬çš„soucemapæ–‡ä»¶å†…è”,å¹¶ä¸”ä½¿ç”¨evalæ‰§è¡Œ,æ–¹ä¾¿ç¼“å­˜,ç¼–è¯‘æ›´å¿«,é‡æ„æ„å»ºå¿«</td></tr> <tr><td style="text-align:center;">cheap-module-eval-source-map</td> <td style="text-align:center;">åŸå§‹ä»£ç (åªæœ‰è¡Œå†…)åŒæ ·é“ç†,ä½†æ˜¯æœ€é«˜çš„è´¨é‡å’Œæœ€ä½çš„æ€§èƒ½</td></tr> <tr><td style="text-align:center;">cheap-eval-source-map</td> <td style="text-align:center;">è½¬æ¢ä»£ç (è¡Œå†…)æ¯ä¸ªæ¨¡å—è¢«evalæ‰§è¡Œ,å¹¶ä¸”sourcemapä½œä¸ºevalçš„ä¸€ä¸ªdefault</td></tr> <tr><td style="text-align:center;">eval</td> <td style="text-align:center;">ç”Ÿæˆä»£ç ,æ¯ä¸ªæ¨¡å—éƒ½è¢«evalæ‰§è¡Œ,å¹¶ä¸”å­˜ä¸‹@sourceURL,å¸¦eval æ¨¡å¼æ„å»ºæ¨¡å¼èƒ½cache SourceMap</td></tr> <tr><td style="text-align:center;">cheap-source-map</td> <td style="text-align:center;">è½¬æ¢ä»£ç (è¡Œå†…)ç”Ÿæˆçš„sourcemapæ²¡æœ‰åˆ—æ˜ å°„,ä»loadersç”Ÿäº§çš„sourcemapæ²¡æœ‰è¢«ä½¿ç”¨</td></tr> <tr><td style="text-align:center;">cheap-module-source-map</td> <td style="text-align:center;">åŸå§‹ä»£ç (åªæœ‰è¡Œå†…),ä¸ä¸Šé¢ä¸€æ ·é™¤äº†æ¯è¡Œç‰¹ç‚¹çš„ä»loaderè¿›è¡Œæ˜ å°„</td></tr></tbody></table> <p>åªæ˜¯ä¸‹é¢äº”ä¸ªå…³é”®è¯çš„ç»„åˆ</p> <table><thead><tr><th style="text-align:center;">å…³é”®è¯</th> <th style="text-align:center;">å«ä¹‰</th></tr></thead> <tbody><tr><td style="text-align:center;">eval</td> <td style="text-align:center;">ä½¿ç”¨evalåŒ…è£¹æ¨¡å—ä»£ç ,è½¬æˆå­—ç¬¦ä¸²,ç¼–è¯‘æ›´å¿«</td></tr> <tr><td style="text-align:center;">soucce-map</td> <td style="text-align:center;">äº§ç”Ÿ.mapæ–‡ä»¶</td></tr> <tr><td style="text-align:center;">cheap</td> <td style="text-align:center;">ä¸åŒ…å«åˆ—ä¿¡æ¯,ä¹Ÿä¸åŒ…å«loaderçš„sourcemap</td></tr> <tr><td style="text-align:center;">module</td> <td style="text-align:center;">åŒ…å«loaderçš„sourcemap,å¦åˆ™æ— æ³•å®šä¹‰çš„æºæ–‡ä»¶</td></tr> <tr><td style="text-align:center;">inline</td> <td style="text-align:center;">å°†.mapä½œä¸ºDataURLå¼•å…¥,ä¸ä¼šå•ç‹¬ç”Ÿäº§.mapæ–‡ä»¶</td></tr></tbody></table> <p><img src="/images/sourcemap.png" alt=""></p> <p>ç¼ºå°‘å‰é¢loaderçš„sourcemapè¿‡ç¨‹</p> <div class="custom-block tip"><p class="custom-block-title">æç¤º</p> <p>ğŸ˜ƒ source-mapåŒ…å«è¡Œå’Œåˆ—çš„ä¿¡æ¯,å¯ä»¥å…·ä½“å®šä½é”™è¯¯<br>
cheap-source-map åªåŒ…å«è¡Œ,ä¸åŒ…å«åˆ—,å®šä½åˆ°ä¸€è¡Œé”™è¯¯<br>
å¼€å‘ç¯å¢ƒæ¨èdevtool:cheap-module-eval-source-map,æ²¡æœ‰åˆ—ä¿¡æ¯,ä½†æ˜¯å¿«(eval),ä¿¡æ¯å…¨(module)<br>
ç”Ÿäº§ç¯å¢ƒæ¨è'hidden-source-map'å¯ä»¥ç”Ÿæˆsourcemapæ–‡ä»¶ç»™é”™è¯¯æ”¶é›†å·¥å…·,åˆä¸ä¼šä¸ºbundleæ·»åŠ å¼•å…¥æ³¨é‡Š,ä»¥å…æµè§ˆå™¨ä½¿ç”¨,æ­¤æ—¶è¡Œå†…é“¾æ¥DataURLåˆ°æœ¬åœ°ç¯å¢ƒ,æ–¹ä¾¿è°ƒè¯•
æŠ˜ä¸­ä½¿ç”¨eval-source-map è¿™æ˜¯vue-cliä½¿ç”¨çš„</p></div> <h3 id="_11-æ‰“åŒ…ç¬¬ä¸‰æ–¹ç±»åº“"><a href="#_11-æ‰“åŒ…ç¬¬ä¸‰æ–¹ç±»åº“" class="header-anchor">#</a> 11 æ‰“åŒ…ç¬¬ä¸‰æ–¹ç±»åº“</h3> <h4 id="_11-1-å®‰è£…"><a href="#_11-1-å®‰è£…" class="header-anchor">#</a> 11.1 å®‰è£…</h4> <div class="language-js extra-class"><pre class="language-js"><code>npm install lodash <span class="token operator">-</span> <span class="token constant">D</span>
</code></pre></div><h4 id="_11-2-ä½¿ç”¨"><a href="#_11-2-ä½¿ç”¨" class="header-anchor">#</a> 11.2 ä½¿ç”¨</h4> <ol><li>ç›´æ¥å¼•å…¥,æ¯æ¬¡éƒ½è¦å¼•å…¥,å¾ˆéº»çƒ¦</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'loadsh'</span>
<span class="token function">alert</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'_'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><ol start="2"><li>æ’ä»¶å¼•å…¥</li></ol> <ul><li>webpack é…ç½®providePluginå,ä½¿ç”¨çš„æ—¶å€™æ— é¡»importå’Œrequireè¿›è¡Œå¼•å…¥,ç›´æ¥ä½¿ç”¨å³å¯</li> <li>_å‡½æ•°ä¼šè‡ªåŠ¨åŒ–æ·»åŠ åˆ°å½“å‰æ¨¡å—çš„ä¸Šä¸‹æ–‡,æ— éœ€æ˜¾ç¤ºå£°æ˜</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">const</span> webpack  <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>

 plugins<span class="token operator">:</span><span class="token punctuation">[</span>
   <span class="token keyword">new</span> <span class="token class-name">webapck<span class="token punctuation">.</span>ProvidePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
     _<span class="token operator">:</span>lodash
   <span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token punctuation">]</span>
</code></pre></div><p>æ­¤æ—¶å…¨å±€ä¸‹æ‹¿ä¸åˆ°<br>
å®‰è£…expose-loader</p> <ul><li>å¯ä»¥å¸®åŠ©æˆ‘ä»¬æŠŠç¬¬ä¸‰æ–¹ç±»åº“æŒ‚è½½åˆ°window</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> module<span class="token operator">:</span><span class="token punctuation">{</span>
   rules<span class="token operator">:</span><span class="token punctuation">{</span>
     <span class="token punctuation">[</span>
       <span class="token punctuation">{</span>
         test<span class="token operator">:</span>require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'lodash'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
         loader<span class="token operator">:</span><span class="token string">'expose_loader'</span><span class="token punctuation">,</span>
         options<span class="token operator">:</span><span class="token punctuation">{</span>
           exposes<span class="token operator">:</span><span class="token punctuation">{</span>
             globalName<span class="token operator">:</span><span class="token string">'_'</span><span class="token punctuation">,</span>
             override<span class="token operator">:</span><span class="token boolean">true</span>
           <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>
     <span class="token punctuation">]</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>


</code></pre></div><p>3.CDNå¼•å…¥,ä½†æ˜¯ç”¨ä¸ç”¨åˆ°éƒ½ä¼šå¼•å…¥,éœ€è¦æ‰‹åŠ¨æ’å…¥
å¦‚æœæˆ‘ä»¬é€šè¿‡CDNå¤–é“¾å¼•å…¥çš„æ–¹å¼å¼•å…¥äº†lodashåº“å¹¶ä¸”æŒ‚è½½åˆ°äº†_å˜é‡ä¸Š</p> <div class="language-js extra-class"><pre class="language-js"><code> externals<span class="token operator">:</span><span class="token punctuation">{</span>
   lodash<span class="token operator">:</span><span class="token string">'_'</span>
 <span class="token punctuation">}</span>
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>
4.å¼•å…¥ html-webpack-externals-pluginå®ç°æŒ‰éœ€åŠ è½½,è€Œä¸”å¯ä»¥è‡ªåŠ¨åœ¨htmlå¼•å…¥cdn

```js

const HtmlWebpackExternalsPlugin = require('html-webpack-externals-plugin')

plugins:[
  new HtmlWebpackExternalsPlugin({
    externals:[
      module:'lodash',
      entry:  cndåœ°å€,
      global:'_'
    ]
  })
]


</code></pre></div><h3 id="_12-å¼€å‘ç¯å¢ƒå’Œçº¿ä¸Šç¯å¢ƒé…ç½®"><a href="#_12-å¼€å‘ç¯å¢ƒå’Œçº¿ä¸Šç¯å¢ƒé…ç½®" class="header-anchor">#</a> 12.å¼€å‘ç¯å¢ƒå’Œçº¿ä¸Šç¯å¢ƒé…ç½®</h3> <ul><li>ç¯å¢ƒå˜é‡æœ‰äºŒä¸ªå˜é‡,ä¸€ä¸ªæ˜¯åœ¨æ¨¡å—å†…éƒ¨ä½¿ç”¨çš„å˜é‡(mode),ä¸€ä¸ªæ˜¯åœ¨nodeè¿›ç¨‹ç¯å¢ƒä¸­ä½¿ç”¨çš„webpack.config.jsä½¿ç”¨çš„å˜é‡,äºŒä¸ªäº’ä¸å½±å“
<ul><li>å‘½ä»¤è¡Œé…ç½®</li> <li>å¯ä»¥é€šè¿‡--mode=developmentæ¥æ”¹å˜modeå€¼</li> <li>å¯ä»¥é€šè¿‡--env= developmentä¼ å‚,ä¼ ç»™webpacké…ç½®æ–‡ä»¶å¯¼å‡ºçš„å‡½æ•°å‚æ•°</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token string">&quot;script&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
   <span class="token string">&quot;build::&quot;</span>webpack <span class="token operator">--</span>mode<span class="token operator">=</span>development&quot;
 <span class="token punctuation">}</span>

</code></pre></div><ul><li>å¦‚æœåœ¨æ‰§è¡Œbuild,æ²¡æœ‰ä¼ --env==development,é‚£ä¹ˆwebpackå¯¼å‡ºçš„å°±æ‹¿ä¸åˆ°å‚æ•°,ä½†æ˜¯ä¸å½±å“mode,äº’ä¸å½±å“</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">env</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>env<span class="token punctuation">)</span> <span class="token comment">//underfined</span>
  <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
     devtool<span class="token operator">:</span><span class="token string">'hidden-source-map'</span><span class="token punctuation">,</span>
     entry<span class="token operator">:</span><span class="token string">'/src/index.js'</span><span class="token punctuation">,</span>
     <span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><ul><li>ä½†æ˜¯ä¼ äº†å…¨å±€ä¹Ÿæ‹¿ä¸åˆ°è¿™ä¸ªä¸œè¥¿æ­¤æ—¶æˆ‘ä»¬éœ€è¦å€ŸåŠ©æ’ä»¶</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>plugins<span class="token operator">:</span><span class="token punctuation">[</span>
  <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token constant">DEVELOPMENT</span><span class="token operator">:</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">,</span>
    <span class="token operator">...</span><span class="token operator">...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>


</code></pre></div><p>æˆ‘ä»¬å¯ä»¥å…¨å±€å®‰è£…cross-env,è§£å†³å…¨å±€å˜é‡é—®é¢˜</p> <div class="language-js extra-class"><pre class="language-js"><code>scripts<span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token string">&quot;build&quot;</span><span class="token operator">:</span><span class="token string">&quot;cross-env NODE_ENV=development webpack&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_13-é…ç½®å¤šå…¥å£"><a href="#_13-é…ç½®å¤šå…¥å£" class="header-anchor">#</a> 13. é…ç½®å¤šå…¥å£</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> pageRoot <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'src'</span><span class="token punctuation">,</span><span class="token string">'pages'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> pages <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readdirSync</span><span class="token punctuation">(</span>pagesRoots<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> htmlWebpackPlugin <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">let</span> entry <span class="token operator">=</span> pages<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">entry<span class="token punctuation">,</span>filename</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> entryName <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">basename</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span><span class="token string">'js'</span><span class="token punctuation">)</span>
  entry<span class="token punctuation">[</span>entryName<span class="token punctuation">]</span> <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>pageRoot<span class="token punctuation">,</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
  htmlWebpackPlugin<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    template<span class="token operator">:</span><span class="token string">'./src/index/html'</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>entryName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.html</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token comment">//è®¾ç½®å¤šé¡µé¢é»˜è®¤å…¥å£</span>
    <span class="token comment">// filename:`${entryName === 'page?':'index.html':entryName }.html`</span>
    chunks<span class="token operator">:</span><span class="token punctuation">[</span>entryName<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment">//ä¸€ä¸ªæ¨¡å—ç›¸äº’ä¾èµ–ç»„æˆäº†chunk</span>
    minify<span class="token operator">:</span><span class="token punctuation">{</span>
      collapseWhitespace<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//å¼€å¯å‹ç¼©</span>
      removeComments<span class="token operator">:</span><span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>




</code></pre></div><h3 id="_14-hash"><a href="#_14-hash" class="header-anchor">#</a> 14.hash</h3> <ul><li>å…¥å£æ¨¡å—ä¾èµ–çš„æ¨¡å—ç»„æˆäº†ä¸€ä¸ªchunk</li> <li>æ–‡ä»¶æŒ‡çº¹,æ˜¯æŒ‡æ‰“åŒ…åè¾“å‡ºæ–‡ä»¶çš„æ–‡ä»¶åå’Œåç¼€</li> <li>hashä¸€èˆ¬æ˜¯ç»“åˆCDNç¼“å­˜æ¥ä½¿ç”¨çš„,é€šè¿‡webpackæ„å»ºä¹‹å,ç”Ÿæˆå¯¹åº”æ–‡ä»¶åè‡ªåŠ¨å¸¦ä¸Šå¯¹åº”çš„MD5å€¼,å¦‚æœæ–‡ä»¶æ”¹å˜,é‚£ä¹ˆå¯¹åº”æ–‡ä»¶çš„hashå€¼ä¹Ÿä¼šæ”¹å˜,å¯¹åº”htmlå¼•å‡ºçš„urlåœ°å€ä¹Ÿä¼šæ”¹å˜,è§¦å‘CDNæœåŠ¡å™¨ä»æºæœåŠ¡å™¨ä¸Šæ‹‰å–å¯¹åº”æ•°æ®,è¿›è€Œæ›´æ–°æœ¬åœ°ç¼“å­˜</li></ul> <table><thead><tr><th style="text-align:center;">å ä½ç¬¦</th> <th style="text-align:center;">å«ä¹‰</th></tr></thead> <tbody><tr><td style="text-align:center;">ext</td> <td style="text-align:center;">èµ„æºåç¼€å</td></tr> <tr><td style="text-align:center;">name</td> <td style="text-align:center;">æ–‡ä»¶åç§°</td></tr> <tr><td style="text-align:center;">hash</td> <td style="text-align:center;">æ¯æ¬¡webpackæ„å»ºç”Ÿæˆçš„å”¯ä¸€hashå€¼</td></tr> <tr><td style="text-align:center;">chunkhash</td> <td style="text-align:center;">æ¯æ¬¡æ ¹æ®chunkç”Ÿæˆçš„hashå€¼,æ¥æºè‡ªåŒä¸€ä¸ªchunk,åˆ™hashå€¼ä¸€æ ·,æ²¡æœ‰ä¾èµ–çš„éƒ¨åˆ†å°±èƒ½ç¼“å­˜,ä¸ä¼šé‡æ–°æ„å»º,åªè¦æ˜¯ä¸€ä¸ªchunkçš„csså’Œjsæ”¹å˜,åˆ™ä¼šæ”¹å˜</td></tr> <tr><td style="text-align:center;">contenthash</td> <td style="text-align:center;">æ ¹æ®å†…å®¹ç”Ÿæˆçš„hashå€¼,æ–‡ä»¶å†…å®¹ç›¸åŒhashç›¸åŒ,æ–‡ä»¶æ”¹å˜æ‰ä¼šæ”¹å˜</td></tr></tbody></table> <ul><li>å¦‚æœå†…å®¹å˜åŒ–å¿«,å»ºè®®hash,å•å…¥å£</li> <li>å¦‚æœéœ€è¦å¤šä¸ªå…¥å£,å»ºè®®chunkhash</li> <li>é•¿æœŸç¼“å­˜,å†…å®¹å˜åŒ–ä¸å¤§,å»ºè®®contenthash</li></ul> <h2 id="webpack-åº•å±‚åŸç†"><a href="#webpack-åº•å±‚åŸç†" class="header-anchor">#</a> webpack åº•å±‚åŸç†</h2> <h3 id="_1-webpackåŒæ­¥æ‰“åŒ…æ–‡ä»¶åˆ†æ"><a href="#_1-webpackåŒæ­¥æ‰“åŒ…æ–‡ä»¶åˆ†æ" class="header-anchor">#</a> 1. webpackåŒæ­¥æ‰“åŒ…æ–‡ä»¶åˆ†æ</h3> <h4 id="_1-1-å‡†å¤‡å·¥ä½œ"><a href="#_1-1-å‡†å¤‡å·¥ä½œ" class="header-anchor">#</a> 1.1 å‡†å¤‡å·¥ä½œ</h4> <ul><li>æ¨¡å—çš„ID : ä¸ç®¡ä½ æ˜¯ç”¨ä»€ä¹ˆæ ·çš„è·¯å¾„æ¥åŠ è½½,æœ€ç»ˆæ¨¡å—çš„IDä¼šå˜æˆç›¸å¯¹æ ¹ç›®å½•çš„ç›¸å¯¹è·¯å¾„</li></ul> <div class="language-html extra-class"><pre class="language-html"><code> - index.js =&gt; ./src/index.js
 - title.js =&gt; ./src/title.js
</code></pre></div><h4 id="_1-2-è¿‡ç¨‹åˆ†æ"><a href="#_1-2-è¿‡ç¨‹åˆ†æ" class="header-anchor">#</a> 1.2 è¿‡ç¨‹åˆ†æ</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
<span class="token comment">// title.js æºä»£ç </span>
 <span class="token keyword">var</span> module <span class="token operator">=</span> <span class="token punctuation">{</span>
   <span class="token string">'./src/title.js'</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">module</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
     module<span class="token punctuation">.</span>export <span class="token operator">=</span> <span class="token string">'title'</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
 
  <span class="token keyword">var</span> cache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token parameter">moduleId</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>cache<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//å…ˆçœ‹ç¼“å­˜é‡Œé¢æœ‰æ²¡æœ‰å·²ç»ç¼“å­˜çš„æ¨¡å—å¯¹è±¡</span>
    <span class="token keyword">return</span> cache<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">.</span>exports <span class="token comment">//å¦‚æœæœ‰ç›´æ¥è¿”å›</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">var</span> module <span class="token operator">=</span> <span class="token punctuation">{</span>
     exports<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   cache<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span> <span class="token operator">=</span> module <span class="token comment">//ä»£ç æ‰§è¡Œæ—¶å€™ä¼šç»™module.exportsèµ‹å€¼</span>
   <span class="token comment">//æ‰§è¡Œmoduleé‡Œé¢çš„å‡½æ•°</span>
    modules<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>exports<span class="token punctuation">,</span>module<span class="token punctuation">,</span>module<span class="token punctuation">.</span>exports<span class="token punctuation">,</span>require<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> module<span class="token punctuation">.</span>exports <span class="token comment">//æ‰§è¡Œè¿”å›æ‰§è¡Œçš„exportså°±è¡Œäº†</span>
  <span class="token punctuation">}</span>
 <span class="token comment">// ä¸»å…¥å£æ–‡ä»¶ä»£ç </span>
 <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
   <span class="token keyword">let</span> title <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./title'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span>

 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="_2-webpackæ¨¡å—çš„å…¼å®¹å¤„ç†"><a href="#_2-webpackæ¨¡å—çš„å…¼å®¹å¤„ç†" class="header-anchor">#</a> 2. webpackæ¨¡å—çš„å…¼å®¹å¤„ç†</h3> <ul><li>ä¸»å…¥å£åŠ è½½ä¸åŒçš„æ¨¡å—</li></ul> <h4 id="_2-1-commom-jsåŠ è½½commom-js"><a href="#_2-1-commom-jsåŠ è½½commom-js" class="header-anchor">#</a> 2.1  commom.jsåŠ è½½commom.js</h4> <ul><li>å†…å®¹æ˜¯ä¸Šé¢webpackåŒæ­¥æ‰“åŒ…æ–‡ä»¶åˆ†æ</li></ul> <h4 id="_2-2-commom-jsåŠ è½½es6-modules"><a href="#_2-2-commom-jsåŠ è½½es6-modules" class="header-anchor">#</a> 2.2 commom.jsåŠ è½½ES6 Modules</h4> <ul><li>index.js</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">let</span> title <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./title'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span>
</code></pre></div><ul><li>title.js</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>  exports<span class="token punctuation">.</span>default <span class="token string">&quot;title.name&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">const</span> age <span class="token operator">=</span> <span class="token string">&quot;title.age&quot;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
<span class="token comment">// title.js æºä»£ç </span>
 <span class="token keyword">var</span> module <span class="token operator">=</span> <span class="token punctuation">{</span>
   <span class="token string">'./src/title.js'</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">module<span class="token punctuation">,</span>exports<span class="token punctuation">,</span>require</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
     <span class="token comment">// ä»£ç æœ‰import æˆ–è€…export webpackè®¤å®šä¸ºes module</span>
    <span class="token comment">// ä¸ç®¡æ˜¯common.js è¿˜æ˜¯es module æœ€åéƒ½ä¼šç¼–è¯‘æˆcommom.js,å¦‚æœåŸæ¥æ˜¯es moduleçš„è¯</span>
    <span class="token comment">//å°±æŠŠexpoetsä¼ ç»™ræ–¹æ³•å¤„ç†ä¸€ä¸‹,exports._esModule = true,ä»¥åé€šè¿‡è¿™ä¸ªå±æ€§åˆ¤æ–­åŸæ¥æ˜¯ä¸æ˜¯es6 æ¨¡å—</span>
     module<span class="token punctuation">.</span>export <span class="token operator">=</span> <span class="token string">'title'</span>

     require<span class="token punctuation">.</span><span class="token function">r</span><span class="token punctuation">(</span>exports<span class="token punctuation">)</span> <span class="token comment">// æ ‡è¯†es6æ¨¡å—</span>
     require<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span><span class="token punctuation">{</span>
       <span class="token function-variable function">default</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">DEFAULT_EXPORT</span><span class="token punctuation">,</span>
       <span class="token function-variable function">age</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">'age'</span><span class="token punctuation">,</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span>
     <span class="token keyword">const</span> <span class="token constant">DEFAULT_EXPORT</span> <span class="token operator">=</span> <span class="token string">'title.name'</span>
     <span class="token keyword">const</span> age  <span class="token operator">=</span> <span class="token string">'title.age'</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
 
  <span class="token keyword">var</span> cache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token parameter">moduleId</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>cache<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token keyword">return</span> cache<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">.</span>exports 
   <span class="token punctuation">}</span>
   <span class="token keyword">var</span> module <span class="token operator">=</span> <span class="token punctuation">{</span>
     exports<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
   cache<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span> <span class="token operator">=</span> module 

    modules<span class="token punctuation">[</span>moduleId<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>exports<span class="token punctuation">,</span>module<span class="token punctuation">,</span>module<span class="token punctuation">.</span>exports<span class="token punctuation">,</span>require<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> module<span class="token punctuation">.</span>exports 
  <span class="token punctuation">}</span>



  <span class="token comment">//æ–°å¢æ–¹æ³•r</span>
   require<span class="token punctuation">.</span><span class="token function-variable function">r</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">exports</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
     <span class="token comment">// è¿™æ ·é€šè¿‡æ‰“å° Object.prototype.call(exports); [object Module]</span>
     <span class="token comment">// Symbol.toStringTagï¼šåœ¨è¯¥å¯¹è±¡ä¸Šé¢è°ƒç”¨Object.prototype.toStringæ–¹æ³•æ—¶ï¼Œå¦‚æœè¿™ä¸ªå±æ€§å­˜åœ¨ï¼Œå®ƒçš„è¿”å›å€¼ä¼šå‡ºç°åœ¨toString  æ–¹æ³•è¿”å›çš„å­—ç¬¦ä¸²ä¹‹ä¸­ï¼Œè¡¨ç¤ºå¯¹è±¡çš„ç±»å‹</span>
    <span class="token comment">//  class Person {</span>
    <span class="token comment">//     get [Symbol.toStringTag]() {</span>
    <span class="token comment">//         return 'Person';</span>
    <span class="token comment">//     }</span>
    <span class="token comment">//   }</span>
    <span class="token comment">//   let p1 = new Person;</span>
    <span class="token comment">//   console.log(Object.prototype.toString.call(p1)); //&quot;[object Person]&quot;</span>

                           <span class="token comment">//ç›®æ ‡å¯¹è±¡     //å±æ€§          //å€¼</span>
     Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span>Symbol<span class="token punctuation">.</span>toStringTag<span class="token punctuation">,</span><span class="token punctuation">{</span>value<span class="token operator">:</span><span class="token string">'module'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment">//æ­¤æ“ä½œå°±æ˜¯èµ‹å€¼exports._esModule = true</span>
   <span class="token punctuation">}</span>
   
  <span class="token comment">// æ–°å¢æ–¹æ³•d</span>
  <span class="token comment">//å¾ªç¯è½¬æ¢æˆexport </span>
  require<span class="token punctuation">.</span><span class="token function-variable function">d</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span>definition</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token function">fo</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">let</span> key <span class="token keyword">in</span> definition</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">//exports[key] = definition[key]</span>
      <span class="token comment">//exports.age ...</span>
      Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span>key<span class="token punctuation">,</span><span class="token punctuation">{</span>enumerable<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>get<span class="token operator">:</span>definition<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
 




 <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
   <span class="token keyword">let</span> title <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./title'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span>

 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><div class="custom-block tip"><p class="custom-block-title">æç¤º</p> <p>ä¸ºä»€ä¹ˆwebpack æ‰“åŒ…å£°æ˜çš„æ–¹æ³•ç”¨ä¸€ä¸ªå­—æ¯?å…¶ä»–çš„åå­—å¾ˆé•¿ <br>
å‡å°æ–‡ä»¶ä½“ç§¯
åŸå› æ˜¯å› ä¸ºä¸€èˆ¬åç§°éƒ½èƒ½è¢«å‹ç¼©æ‰“åŒ…,ä½†æ˜¯å¯¹è±¡çš„å±æ€§æ˜¯ä¸èƒ½è¢«å‹ç¼©çš„</p></div> <h4 id="_2-3-es6-modulesåŠ è½½es6-modules"><a href="#_2-3-es6-modulesåŠ è½½es6-modules" class="header-anchor">#</a> 2.3 ES6 ModulesåŠ è½½ES6 Modules</h4> <ul><li>éƒ½åˆ†åˆ«å¤„ç†ä¸€ä¸‹,ç”¨ræ–¹æ³•å’Œdæ–¹æ³•</li></ul> <h4 id="_2-4-es6-modulesåŠ è½½commom-js"><a href="#_2-4-es6-modulesåŠ è½½commom-js" class="header-anchor">#</a> 2.4 ES6 ModulesåŠ è½½commom.js</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//index.jsæ–°å¢æ–¹æ³•nå¤„ç†</span>
 require<span class="token punctuation">.</span><span class="token function-variable function">n</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">exports</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
   <span class="token keyword">var</span> getter  <span class="token operator">=</span> exports<span class="token punctuation">.</span>_esModule <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> exports<span class="token punctuation">.</span><span class="token function-variable function">default</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> exports
   <span class="token keyword">return</span> getter
 <span class="token punctuation">}</span>

</code></pre></div><h3 id="_3-astæŠ½è±¡è¯­æ³•æ ‘"><a href="#_3-astæŠ½è±¡è¯­æ³•æ ‘" class="header-anchor">#</a> 3. ASTæŠ½è±¡è¯­æ³•æ ‘</h3> <ul><li><p>webpackæ˜¯é€šè¿‡æŠ½è±¡è¯­æ³•æ ‘æ¥å®ç°å¯¹ä»£ç çš„æ£€æŸ¥å’Œåˆ†æç­‰æ“ä½œ</p></li> <li><p>ç”¨é€”</p> <ul><li>ä»£ç è¯­æ³•çš„æ£€æŸ¥,æ ¼å¼åŒ–ç­‰ç­‰</li> <li>ä»£ç æ··æ·†å‹ç¼©</li> <li>ä¸åŒä»£ç è§„èŒƒè´¨æ£€çš„è½¬æ¢,jsx,tsè½¬æ¢æˆjs</li></ul></li> <li><p>åŸç†: é€šè¿‡javaScript ParseæŠŠä»£ç è½¬æˆæŠ½è±¡è¯­æ³•ä¹¦,è¿™æ£µæ ‘å®šä¹‰ä»£ç ç»“æ„,é€šè¿‡æ“ä½œå¯ä»¥ç²¾å‡†å®šä½å£°æ˜è¯­å¥,è¿ç®—ç­‰ç­‰å¯¹ä»£ç åˆ†æä¼˜åŒ–</p> <ul><li>ç¬¬ä¸€æ­¥å…ˆåˆ†è¯,æŠŠå…³é”®è¯è½¬æ¢æˆä¸€ä¸ªä¸ªtoken(è¯æ³•åˆ†æ)</li> <li>ç¬¬äºŒæ­¥è½¬æˆæŠ½è±¡è¯­æ³•æ ‘(è¯­æ³•åˆ†æ)</li></ul></li></ul> <h4 id="_3-1-javascript-parser"><a href="#_3-1-javascript-parser" class="header-anchor">#</a> 3.1 JavaScript Parser</h4> <ul><li>JavaScript Parser,æŠŠjsæºç æŠ“æ¢æˆæŠ½è±¡è¯­æ³•æ ‘çš„è§£æå™¨</li> <li>æµè§ˆå™¨ä¼šæŠŠjsæºç é€šè¿‡è§£æå™¨è½¬ä¸ºæŠ½è±¡è¯­æ³•æ ‘,å†è¿›ä¸€æ­¥è½¬æ¢æˆå­—èŠ‚ç æˆ–è€…ç›´æ¥ç”Ÿæˆæœºå™¨ç </li></ul> <h4 id="_3-2-å¸¸ç”¨çš„javascript-parser-esprima"><a href="#_3-2-å¸¸ç”¨çš„javascript-parser-esprima" class="header-anchor">#</a> 3.2 å¸¸ç”¨çš„JavaScript Parser   esprima</h4> <ul><li>é€šè¿‡<font color="red">esprima</font>æŠŠæºç è½¬æ¢æˆAST</li> <li>é€šè¿‡<font color="red">estraverse</font>éå†æ›´æ–°AST</li> <li>é€šè¿‡<font color="red">escodegen</font>å°†ASTé‡æ–°ç”Ÿæˆæºç </li> <li><a href="https://astexplorer.net/" target="_blank" rel="noopener noreferrer">astexplorer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>  ASTçš„å¯è§†åŒ–å·¥å…·</li></ul> <h4 id="_3-3-å®‰è£…"><a href="#_3-3-å®‰è£…" class="header-anchor">#</a> 3.3 å®‰è£…</h4> <div class="language-js extra-class"><pre class="language-js"><code>cnpm i esprima estraverse escodegen <span class="token operator">-</span><span class="token constant">S</span>

</code></pre></div><h4 id="_3-4-ä½¿ç”¨"><a href="#_3-4-ä½¿ç”¨" class="header-anchor">#</a> 3.4 ä½¿ç”¨</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> esprima <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;esprima&quot;</span><span class="token punctuation">)</span> <span class="token comment">//æŠŠæºç è½¬æˆæŠ½è±¡è¯­æ³•æ ‘</span>
<span class="token keyword">let</span> estraverse <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;estraverse&quot;</span><span class="token punctuation">)</span> 
<span class="token keyword">let</span> escodegen <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;escodegen&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> soureCode <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">function ast(){}</span><span class="token template-punctuation string">`</span></span>
<span class="token keyword">let</span> ast <span class="token operator">=</span> esprima<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>soureCode<span class="token punctuation">)</span>
<span class="token keyword">let</span> indent <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">const</span> <span class="token function-variable function">padding</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span>indent<span class="token punctuation">)</span>


<span class="token comment">//éå†è¯­æ³•æ ‘,æ·±åº¦ä¼˜å…ˆ</span>
<span class="token comment">//å¦‚æœä¸€ä¸ªéå†èŠ‚ç‚¹å®Œæˆ,åŒæ—¶æœ‰å„¿å­å’Œå¼Ÿå¼Ÿ,å¦‚æœå…ˆéå†å¼Ÿå¼Ÿ,å°±æ˜¯å¹¿åº¦,å…ˆéå†å„¿å­,å°±æ˜¯æ·±åº¦</span>
estraverse<span class="token punctuation">.</span><span class="token function">traverse</span><span class="token punctuation">(</span>ast<span class="token punctuation">,</span><span class="token punctuation">{</span>
    <span class="token function">enter</span><span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'è¿›å…¥'</span> <span class="token operator">+</span> node<span class="token punctuation">.</span>type<span class="token punctuation">)</span>    
      indent <span class="token operator">+=</span> <span class="token number">2</span>         
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">leave</span><span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     indent <span class="token operator">-=</span> <span class="token number">2</span>   
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">padding</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'ç¦»å¼€'</span> <span class="token operator">+</span> node<span class="token punctuation">.</span>type<span class="token punctuation">)</span>       
           
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token keyword">let</span> original <span class="token operator">=</span> escodegen<span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span>ast<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span>


</code></pre></div><h3 id="_4-å®ç°ç®­å¤´å‡½æ•°è½¬æ¢"><a href="#_4-å®ç°ç®­å¤´å‡½æ•°è½¬æ¢" class="header-anchor">#</a> 4.å®ç°ç®­å¤´å‡½æ•°è½¬æ¢</h3> <ul><li>åˆ©ç”¨æ’ä»¶babelPluginTransformEs2015ArrowFunctions</li></ul> <h4 id="_4-1-å®‰è£…-2"><a href="#_4-1-å®‰è£…-2" class="header-anchor">#</a> 4.1 å®‰è£…</h4> <div class="language-js extra-class"><pre class="language-js"><code>cnpm i babel<span class="token operator">-</span>plugin<span class="token operator">-</span>transform<span class="token operator">-</span>es2015<span class="token operator">-</span>arrow<span class="token operator">-</span>functions <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><h4 id="_4-2-ä½¿ç”¨-2"><a href="#_4-2-ä½¿ç”¨-2" class="header-anchor">#</a> 4.2 ä½¿ç”¨</h4> <div class="language-js extra-class"><pre class="language-js"><code>

<span class="token keyword">let</span> core <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@babel/core'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> types <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'babel-types'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> babelPluginTransformEs2015ArrowFunctions <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'babel-plugin-transform-es2015-arrow-functions'</span><span class="token punctuation">)</span>

 <span class="token keyword">const</span> sourceCode <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  const sum = (a,b)=&gt;{
      console.log(this)
      return a+b;
  }
</span><span class="token template-punctuation string">`</span></span>
<span class="token comment">//babel-codeæœ¬èº«åªç”¨æ¥ç”Ÿæˆè¯­æ³•æ ‘,éå†è¯­æ³•æ ‘,ä¸è´Ÿè´£è½¬æ¢è¯­æ³•æ ‘</span>
<span class="token keyword">let</span> targetCode <span class="token operator">=</span> core<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span>sourceCode<span class="token punctuation">,</span><span class="token punctuation">{</span>
    plugins<span class="token operator">:</span><span class="token punctuation">[</span>babelPluginTransformEs2015ArrowFunctions<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>targetCode<span class="token punctuation">.</span>code<span class="token punctuation">)</span>

<span class="token comment">// var _this = this;</span>

<span class="token comment">// const sum = function (a, b) {</span>
<span class="token comment">//   console.log(_this);</span>
<span class="token comment">//   return a + b;</span>
<span class="token comment">// };</span>


</code></pre></div><h4 id="_4-3-æ‰‹åŠ¨å®ç°babel-plugin-transform-es2015-arrow-functions"><a href="#_4-3-æ‰‹åŠ¨å®ç°babel-plugin-transform-es2015-arrow-functions" class="header-anchor">#</a> 4.3 æ‰‹åŠ¨å®ç°babel-plugin-transform-es2015-arrow-functions</h4> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">let</span> core <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@babel/core'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> types <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'babel-types'</span><span class="token punctuation">)</span>


 <span class="token keyword">const</span> sourceCode <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
const sum = (a,b)=&gt;{
    console.log(this)
    return a+b;
}
</span><span class="token template-punctuation string">`</span></span>
<span class="token comment">//babel æ’ä»¶æ˜¯ä¸€ä¸ªå¯¹è±¡,å®ƒä¼šæœ‰ä¸€ä¸ªvistorè®¿é—®å™¨</span>
<span class="token keyword">let</span> babelPluginTransformEs2015ArrowFunctions2 <span class="token operator">=</span> <span class="token punctuation">{</span>
    visitor<span class="token operator">:</span><span class="token punctuation">{</span>
       <span class="token function">ArrowFunctionExpression</span><span class="token punctuation">(</span><span class="token parameter">nodePath</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//å‚æ•°æ˜¯èŠ‚ç‚¹æ•°æ®</span>
          <span class="token keyword">let</span> node <span class="token operator">=</span> nodePath<span class="token punctuation">.</span>node <span class="token comment">//è·å–è·¯å¾„èŠ‚ç‚¹</span>
          <span class="token keyword">debugger</span>
          <span class="token keyword">const</span> thisBinding <span class="token operator">=</span> <span class="token function">hoistFunctionEnvironment</span><span class="token punctuation">(</span>nodePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
         
          node<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'FunctionExpression'</span>
       <span class="token punctuation">}</span> 
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>



<span class="token keyword">function</span> <span class="token function">getScopeInfoInformation</span><span class="token punctuation">(</span><span class="token parameter">fnPath</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token keyword">let</span> thisPaths <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
     fnPath<span class="token punctuation">.</span><span class="token function">traverse</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token comment">//éå†å½“å‰çš„pathæ‰€æœ‰å­èŠ‚ç‚¹,çœ‹çœ‹è°çš„ç±»å‹æ˜¯ThisExpression</span>
         <span class="token function">ThisExpression</span><span class="token punctuation">(</span><span class="token parameter">thisPath</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            thisPaths<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>thisPath<span class="token punctuation">)</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span>
     <span class="token keyword">return</span> thisPaths
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">hoistFunctionEnvironment</span><span class="token punctuation">(</span><span class="token parameter">fnPath</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token comment">//thisEnvFn==Program,æ‰¾åˆ°æ ¹èŠ‚ç‚¹</span>
   <span class="token keyword">const</span> thisEnvFn <span class="token operator">=</span> fnPath<span class="token punctuation">.</span><span class="token function">findParent</span><span class="token punctuation">(</span> <span class="token parameter">p</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
       <span class="token keyword">return</span> <span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">isFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>p<span class="token punctuation">.</span>isArrowFunctionExpression<span class="token punctuation">)</span> <span class="token operator">||</span> p<span class="token punctuation">.</span><span class="token function">isProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span>
 
<span class="token comment">//    console.log(thisEnvFn)</span>

   <span class="token comment">//thisPathsæ”¾ç€å“ªäº›åœ°æ–¹ç”¨åˆ°this</span>
   <span class="token keyword">let</span> thisPaths <span class="token operator">=</span> <span class="token function">getScopeInfoInformation</span><span class="token punctuation">(</span>fnPath<span class="token punctuation">)</span>
   <span class="token keyword">let</span> thisBinding <span class="token operator">=</span> <span class="token string">'_this'</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>thisPaths<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
       <span class="token comment">//åœ¨çˆ¶èŠ‚ç‚¹ä½œç”¨åŸŸæ·»åŠ ä¸€ä¸ªå˜é‡id _this,åˆå§‹å€¼   this =&gt; thisExpression</span>
    thisEnvFn<span class="token punctuation">.</span>scope<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        id<span class="token operator">:</span>types<span class="token punctuation">.</span><span class="token function">identifier</span><span class="token punctuation">(</span>thisBinding<span class="token punctuation">)</span><span class="token punctuation">,</span>
        init<span class="token operator">:</span>types<span class="token punctuation">.</span><span class="token function">thisExpression</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token comment">//éå†æ‰€æœ‰ç”¨åˆ°thisè·¯å¾„èŠ‚ç‚¹,æŠŠæ‰€æœ‰thisExpressionå˜æˆ_thisæ ‡è¯†ç¬¦</span>
   thisPaths<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">thisChild</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
       <span class="token keyword">let</span> thisRef <span class="token operator">=</span> types<span class="token punctuation">.</span><span class="token function">identifier</span><span class="token punctuation">(</span>thisBinding<span class="token punctuation">)</span>
       thisChild<span class="token punctuation">.</span><span class="token function">replaceWith</span><span class="token punctuation">(</span>thisRef<span class="token punctuation">)</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token punctuation">}</span>

<span class="token comment">//babel-codeæœ¬èº«åªç”¨æ¥ç”Ÿæˆè¯­æ³•æ ‘,éå†è¯­æ³•æ ‘,ä¸è´Ÿè´£è½¬æ¢è¯­æ³•æ ‘</span>
<span class="token keyword">let</span> targetCode <span class="token operator">=</span> core<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span>sourceCode<span class="token punctuation">,</span><span class="token punctuation">{</span>
    plugins<span class="token operator">:</span><span class="token punctuation">[</span>babelPluginTransformEs2015ArrowFunctions2<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>targetCode<span class="token punctuation">.</span>code<span class="token punctuation">)</span>


</code></pre></div><h3 id="_5-webpack-å·¥ä½œæµ"><a href="#_5-webpack-å·¥ä½œæµ" class="header-anchor">#</a> 5.webpack å·¥ä½œæµ</h3> <h4 id="_5-1-webpackç¼–è¯‘æµç¨‹"><a href="#_5-1-webpackç¼–è¯‘æµç¨‹" class="header-anchor">#</a> 5.1 webpackç¼–è¯‘æµç¨‹</h4> <ol><li>åˆå§‹åŒ–å‚æ•°,ä»é…ç½®æ–‡ä»¶å’Œshellè¯­å¥ä¸­è¯»å–åˆå¹¶å‚æ•°,å¾—åˆ°æœ€ç»ˆçš„é…ç½®å¯¹è±¡</li> <li>ç”¨ä¸Šä¸€æ­¥çš„åˆ°çš„å‚æ•°åˆå§‹åŒ–Compilerå¯¹è±¡</li> <li>åŠ è½½æ‰€æœ‰é…ç½®çš„æ’ä»¶</li> <li>æ‰§è¡Œå¯¹è±¡çš„runæ–¹æ³•å¼€å§‹ç¼–è¯‘</li> <li>æ ¹æ®é…ç½®ä¸­çš„entryæ‰¾åˆ°å…¥å£æ–‡ä»¶</li> <li>ä»å…¥å£æ–‡ä»¶å‡ºå‘,è°ƒç”¨æ‰€æœ‰é…ç½®çš„loaderå¯¹æ¨¡å—è¿›è¡Œç¼–è¯‘</li> <li>å†é€’å½’æœ¬æ­¥éª¤ç›´åˆ°æ‰€æœ‰å…¥å£ä¾èµ–çš„æ–‡ä»¶éƒ½ç»è¿‡æœ¬æ­¥éª¤å¤„ç†(æ‰¾åˆ°æ‰€æœ‰ä¾èµ–)</li> <li>æ ¹æ®å…¥å£å’Œæ¨¡å—ä¹‹é—´çš„å…³ç³»,ç»„è£…æˆä¸€ä¸ªä¸ªåŒ…è£…å¤šä¸ªæ¨¡å—çš„chunk</li> <li>ç¡®å®šå¥½è¾“å‡ºå†…å®¹å,æ ¹æ®é…ç½®å’Œè¾“å‡ºè·¯å¾„å’Œæ–‡ä»¶å,æŠŠå†…å®¹å†™è¿›æ–‡ä»¶ç³»ç»Ÿ</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> <span class="token punctuation">{</span>Synchook<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>'tapable<span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path)'</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> parser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/babel/parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è§£æå™¨ æºä»£ç è½¬æˆASTæŠ½è±¡è¯­æ³•æ ‘</span>
<span class="token keyword">const</span> types <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;babel-types&quot;</span><span class="token punctuation">)</span> <span class="token comment">//ç”ŸæˆèŠ‚ç‚¹</span>
<span class="token keyword">const</span> traverse <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@/babel/traverse'</span><span class="token punctuation">)</span> <span class="token comment">//éå†è¯­æ³•æ ‘å™¨</span>
<span class="token keyword">const</span> generator <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@/babel/generator&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default <span class="token comment">//è¯­æ³•æ ‘é‡å†™ç”Ÿæˆä»£ç </span>

<span class="token comment">//webpackå†…éƒ¨ç”¨çš„æ˜¯acorn</span>

<span class="token keyword">class</span> <span class="token class-name">Compiler</span><span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">option</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>option <span class="token operator">=</span> option
      <span class="token keyword">this</span><span class="token punctuation">.</span>hooks <span class="token operator">=</span> <span class="token punctuation">{</span>
        run<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Synchook</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//å¼€å§‹ç¼–è¯‘æ—¶å€™è§¦å‘</span>
        done<span class="token operator">:</span><span class="token keyword">new</span> <span class="token class-name">Synchook</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//ä¼šåœ¨å®Œæˆç¼–è¯‘çš„æ—¶å€™è§¦å‘</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//4. æ‰§è¡Œå¯¹è±¡çš„runæ–¹æ³•å¼€å§‹ç¼–è¯‘</span>
  <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> modules <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//æ‰§è¡Œrunæ–¹æ³•çš„æ—¶å€™è§¦å‘runé’©å­,è¿›è€Œæ‰§è¡Œå®ƒçš„å›è°ƒå‡½æ•°</span>

  <span class="token comment">// 5. æ ¹æ®é…ç½®ä¸­çš„entryæ‰¾åˆ°å…¥å£æ–‡ä»¶</span>
   <span class="token comment">// context:process.cwd() æ ¹ç›®å½•</span>
   <span class="token keyword">let</span> entry <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>option<span class="token punctuation">.</span>context<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>entry<span class="token punctuation">)</span>

     <span class="token comment">//6 ä»å…¥å£æ–‡ä»¶å‡ºå‘,è°ƒç”¨æ‰€æœ‰é…ç½®çš„loaderå¯¹æ¨¡å—è¿›è¡Œç¼–è¯‘</span>
   <span class="token keyword">let</span>  entryModule <span class="token operator">=</span> <span class="token function">buildModule</span><span class="token punctuation">(</span>entry<span class="token punctuation">)</span>
   <span class="token comment">// 7.å†é€’å½’æœ¬æ­¥éª¤ç›´åˆ°æ‰€æœ‰å…¥å£ä¾èµ–çš„æ–‡ä»¶éƒ½ç»è¿‡æœ¬æ­¥éª¤å¤„ç†(æ‰¾åˆ°æ‰€æœ‰ä¾èµ–)</span>
   entryModule<span class="token punctuation">.</span>dependencies<span class="token punctuation">.</span><span class="token function">foreach</span><span class="token punctuation">(</span><span class="token parameter">dependency</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
     <span class="token keyword">let</span> dependencyModule <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">buildModule</span><span class="token punctuation">(</span>dependency<span class="token punctuation">)</span><span class="token punctuation">]</span>
     modules<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>dependencyModule<span class="token punctuation">)</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token comment">//8. æ ¹æ®å…¥å£å’Œæ¨¡å—ä¹‹é—´çš„å…³ç³»,ç»„è£…æˆä¸€ä¸ªä¸ªåŒ…è£…å¤šä¸ªæ¨¡å—çš„chunk</span>
   <span class="token keyword">let</span> chunk <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">'main'</span><span class="token punctuation">,</span>entryModule<span class="token punctuation">,</span>module<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>modules<span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token comment">//å†æŠŠæ¯ä¸ªchunkè½¬æ¢æˆä¸€ä¸ªå•ç‹¬æ–‡ä»¶åŠ å…¥åˆ°è¾“å‡ºåˆ—è¡¨</span>
   <span class="token keyword">this</span><span class="token punctuation">.</span>chunks<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">chunk</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token comment">//  this.assets[chunk.name + 'js'] = getsource(chunk) å‡è®¾åªæœ‰ä¸€ä¸ªchunk.åé¢å°±æ˜¯å†…å®¹</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token comment">//9. ç¡®å®šå¥½è¾“å‡ºå†…å®¹å,æ ¹æ®é…ç½®å’Œè¾“å‡ºè·¯å¾„å’Œæ–‡ä»¶å,æŠŠå†…å®¹å†™è¿›æ–‡ä»¶ç³»ç»Ÿ</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> file <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">.</span>assets<span class="token punctuation">)</span><span class="token punctuation">{</span>
     fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./dist/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>file<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>assets<span class="token punctuation">[</span>file<span class="token punctuation">]</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">buildModule</span><span class="token punctuation">(</span><span class="token parameter">modulePath</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token comment">//è¯»å–åŸå§‹ä»£ç </span>
   <span class="token keyword">let</span> originalSourceCode <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>modulePath<span class="token punctuation">,</span><span class="token string">'uft-8'</span><span class="token punctuation">)</span>
   <span class="token comment">//æŸ¥æ‰¾loaderå¯¹ä»£ç ä½ è¿›è¡Œè½¬æ¢</span>
   <span class="token keyword">let</span> rules <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>option<span class="token punctuation">.</span>module<span class="token punctuation">.</span>rules
   <span class="token keyword">let</span> loaders <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span> <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rules<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token comment">//æ­£åˆ™åŒ¹é…ä¸Šæ¨¡å—çš„è·¯å¾„</span>
     <span class="token keyword">if</span><span class="token punctuation">(</span>rules<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>test<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token parameter">modulePath</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
       loaders <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>loaders<span class="token punctuation">,</span><span class="token operator">...</span>rules<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>use<span class="token punctuation">]</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span> loaders<span class="token punctuation">.</span>length<span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">;</span> i<span class="token operator">&gt;=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token keyword">let</span> loader <span class="token operator">=</span> loader<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
     <span class="token comment">//loaderå‡½æ•°</span>
    <span class="token comment">//  function loader(source){</span>
    
    <span class="token comment">//   }</span>
  
     <span class="token comment">//æŠŠä¸Šä¸€ä¸ªloaderå¤„ç†ç»“æœäº¤ç»™ä¸‹ä¸€ä¸ªloader</span>
     <span class="token keyword">let</span>  targetSourceCode <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>loader<span class="token punctuation">)</span><span class="token punctuation">(</span>targetSourceCode<span class="token punctuation">)</span>
     <span class="token keyword">let</span> baseDir <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\\/g</span><span class="token punctuation">,</span><span class="token string">'/'</span><span class="token punctuation">)</span>
     <span class="token comment">//ç°åœ¨å·²ç»å¾—åˆ°è½¬æ¢åçš„ä»£ç  babel-loader es6 =&gt;es5</span>
     <span class="token comment">//å†æ‰¾å‡ºè¯¥æ¨¡å—ä¾èµ–çš„æ¨¡å—,å†é€’å½’æœ¬æ­¥éª¤ä¹‹é“æ‰€æœ‰å…¥å£ä¾èµ–çš„æ–‡ä»¶éƒ½ç»è¿‡äº†æœ¬æ­¥éª¤çš„å¤„ç†</span>
     <span class="token keyword">let</span> moduleId <span class="token operator">=</span> <span class="token string">'./'</span> <span class="token operator">+</span> path<span class="token punctuation">.</span>posix<span class="token punctuation">.</span><span class="token function">relative</span><span class="token punctuation">(</span>baseDir<span class="token punctuation">,</span>modulePath<span class="token punctuation">)</span>
       <span class="token keyword">let</span> module <span class="token operator">=</span> <span class="token punctuation">{</span>id<span class="token operator">:</span>moduleId<span class="token punctuation">,</span>dependenices<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
     <span class="token keyword">let</span>  astTree <span class="token operator">=</span> parse<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>targetSourceCode<span class="token punctuation">,</span><span class="token punctuation">{</span>sourceType<span class="token operator">:</span><span class="token string">'module'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token function">traverse</span><span class="token punctuation">(</span>astTree<span class="token punctuation">,</span><span class="token punctuation">{</span>
       <span class="token function">CallExpression</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>node<span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>callee<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">'require'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">let</span> moduleName <span class="token operator">=</span> node<span class="token punctuation">.</span>argument<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value
            <span class="token keyword">let</span> dirname <span class="token operator">=</span> path<span class="token punctuation">.</span>posix<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span>modulePath<span class="token punctuation">)</span>
            <span class="token keyword">let</span> depModulePath <span class="token operator">=</span> path<span class="token punctuation">.</span>posix<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span>moduleName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> extnsion <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>reslove<span class="token punctuation">.</span>extension
             depModulePath <span class="token operator">=</span> <span class="token function">tryExtensions</span><span class="token punctuation">(</span>depModulePath<span class="token punctuation">,</span>extensions<span class="token punctuation">,</span>moduleName<span class="token punctuation">,</span>dirname<span class="token punctuation">)</span>
             <span class="token comment">//æ¨¡å—Idé—®é¢˜</span>
             <span class="token keyword">let</span> depModuleId <span class="token operator">=</span> <span class="token string">'./'</span> <span class="token operator">+</span> path<span class="token punctuation">.</span>posix<span class="token punctuation">.</span><span class="token function">relative</span><span class="token punctuation">(</span>baseDir<span class="token punctuation">,</span>depModulePath<span class="token punctuation">)</span>
             <span class="token comment">//ä¿®æ”¹æŠ½è±¡è¯­æ³•æ ‘</span>
             node<span class="token punctuation">.</span>arguments <span class="token operator">=</span> <span class="token punctuation">[</span>types<span class="token punctuation">.</span><span class="token function">stringLiteral</span><span class="token punctuation">(</span>depModuleId<span class="token punctuation">)</span><span class="token punctuation">]</span>
             module<span class="token punctuation">.</span>dependencies<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>depModulePath<span class="token punctuation">)</span>
         <span class="token punctuation">}</span>
       <span class="token punctuation">}</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span>
     <span class="token comment">//æ ¹æ®æ–°çš„è¯­æ³•æ ‘ç”Ÿæˆæ–°ä»£ç </span>
     <span class="token keyword">let</span> <span class="token punctuation">{</span>code<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">generator</span><span class="token punctuation">(</span>astTree<span class="token punctuation">)</span>
     module<span class="token punctuation">.</span>_souce <span class="token operator">=</span> code
   <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//æ¨¡å—idæ˜¯æ­¤æ¨¡å—ç»å¯¹è·¯å¾„ç›¸å½“äºæ ¹ç›®å½•çš„ç›¸å¯¹è·¯å¾„</span>
  <span class="token keyword">function</span> <span class="token function">tryExtensions</span><span class="token punctuation">(</span><span class="token parameter">modulePath<span class="token punctuation">,</span>extensions<span class="token punctuation">,</span>originalModulePath<span class="token punctuation">,</span>moduleContext</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> extension<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
       <span class="token keyword">if</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">existSync</span><span class="token punctuation">(</span>modulePath<span class="token operator">+</span>extension<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token keyword">return</span> modulePath<span class="token operator">+</span>extension<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
       <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> Compiler

</code></pre></div><ul><li>æ’ä»¶</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">DonePlugin</span><span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> options
  <span class="token punctuation">}</span>

  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//æ³¨å†Œç›‘å¬æ„Ÿå…´è¶£çš„é’©å­</span>
     compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>run<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">'DonePlugin'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'111'</span><span class="token punctuation">)</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">//   compiler.hooks.done.tap('DonePlugin',() =&gt;{</span>
    <span class="token comment">//    console.log('111')</span>
    <span class="token comment">//  })</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> DonePlugin

</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> Compiler <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span>'<span class="token punctuation">.</span><span class="token operator">/</span>Compiler<span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">webpack</span><span class="token punctuation">(</span><span class="token parameter">option</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
 <span class="token comment">//åˆå§‹åŒ–å‚æ•°,ä»é…ç½®æ–‡ä»¶å’Œshellè¯­å¥ä¸­è¯»å–å’Œåˆå¹¶å‚æ•°,å¾—åˆ°æœ€ç»ˆçš„é…ç½®å¯¹è±¡</span>
 <span class="token comment">// process.argv å‘½ä»¤è¡Œå‚æ•° æ•°ç»„ ( 1.node.exeç»å¯¹è·¯å¾„ , 2.è„šæœ¬è·¯å¾„,   3.å‚æ•°--mode=***,)</span>
 process<span class="token punctuation">.</span>argv<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">shellConfig<span class="token punctuation">,</span>item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
   <span class="token keyword">let</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span>value<span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;=&quot;</span><span class="token punctuation">)</span>  <span class="token comment">//--mode=development</span>
   shellConfig<span class="token punctuation">[</span>key<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> value
   <span class="token keyword">return</span> shellConfig
 <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token keyword">let</span> finalOption <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">...</span>option<span class="token punctuation">,</span><span class="token operator">...</span>shellConfig<span class="token punctuation">}</span>

  <span class="token comment">//2. ç”¨ä¸Šä¸€æ­¥çš„åˆ°çš„å‚æ•°åˆå§‹åŒ–Compilerå¯¹è±¡</span>
  <span class="token keyword">let</span> compiler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Compiler</span><span class="token punctuation">(</span>finalOption<span class="token punctuation">)</span>

 <span class="token comment">// 3. åŠ è½½æ‰€æœ‰é…ç½®çš„æ’ä»¶(ä¸€å¼€å§‹å°±æŒ‚è½½äº†)</span>
 <span class="token comment">//æ‰§è¡Œæ˜¯æ‰¾åˆ°å¯¹åº”çš„é’©å­æ‰ä¼šæ‰§è¡Œ</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span>finalOption<span class="token punctuation">.</span>plugins <span class="token operator">&amp;&amp;</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>inalOption<span class="token punctuation">.</span>plugins<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> plugin <span class="token keyword">of</span> finalOption<span class="token punctuation">.</span>plugins<span class="token punctuation">)</span><span class="token punctuation">{</span>
       <span class="token function">plugin</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>Compiler<span class="token punctuation">)</span>
     <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
  <span class="token keyword">return</span> compiler
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> webpack


</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webapck'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> option <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.config'</span><span class="token punctuation">)</span>
<span class="token comment">//æ‰§è¡Œwebpackå¾—åˆ°æ ¸å¿ƒç¼–è¯‘å¯¹è±¡Compiler,å°±æ˜¯ä¸€ä¸ªå¤§ç®¡ç†,æ˜¯æ ¸å¿ƒç¼–è¯‘å¯¹è±¡</span>
<span class="token keyword">const</span>  compiler <span class="token operator">=</span> <span class="token function">webpack</span><span class="token punctuation">(</span>option<span class="token punctuation">)</span><span class="token punctuation">;</span>
compiler<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="_6-loader-runer"><a href="#_6-loader-runer" class="header-anchor">#</a> 6.loader-runer</h3> <ul><li>æ‰€è°“loaderåªæ˜¯ä¸€ä¸ªå¯¼å‡ºä¸ºå‡½æ•°çš„jsæ¨¡å—,å®ƒæ¥å—ä¸Šä¸€ä¸ªloaderäº§ç”Ÿçš„ç»“æœæˆ–è€…èµ„æºæ–‡ä»¶ä½œä¸ºå…¥å‚,ä¹Ÿå¯ä»¥ç”¨å¤šä¸ªloaderå‡½æ•°ç»„æˆloader chain</li> <li>compileréœ€è¦å¾—åˆ°æœ€åä¸€ä¸ªloaderäº§ç”Ÿçš„å¤„ç†ç»“æœ,è¿™ä¸ªç»“æœåº”è¯¥æ˜¯Stringæˆ–è€…Buffer(è¢«è½¬æ¢ä¸ºä¸€ä¸ªstring)</li></ul> <h4 id="_6-1-loader-runner"><a href="#_6-1-loader-runner" class="header-anchor">#</a> 6.1 loader-runner</h4> <ul><li>loader-runneræ˜¯ä¸€ä¸ªæ‰§è¡Œloaderé“¾æ¡çš„æ¨¡å—</li> <li>loaderçš„å åŠ é¡ºåº = post(åç½®) + inline(å†…è”) + normal(æ­£å¸¸) + pre(å‰ç½®)</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>runLoaders<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;loader-runner&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> resource <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'src'</span><span class="token punctuation">,</span><span class="token string">'index.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> loaders <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'loaders'</span><span class="token punctuation">,</span><span class="token string">'inline-loader1.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">'loaders'</span><span class="token punctuation">,</span><span class="token string">'normal-loader2.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
<span class="token function">runLoaders</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    resource<span class="token punctuation">,</span>
    loaders<span class="token punctuation">,</span>
    context<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    readResource<span class="token operator">:</span>fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>fs<span class="token punctuation">)</span>

<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>result</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>


</code></pre></div><p><img src="/images/loader.jpg" alt=""></p> <h4 id="_6-2-pitch"><a href="#_6-2-pitch" class="header-anchor">#</a> 6.2 pitch</h4> <ul><li>æ­£ç¡®è°ƒç”¨åº”è¯¥æ˜¯a(pitch),b(pitch),c(pitch),c,b,a,ä»»ä½•ä¸€ä¸ªå€¼åœ¨pitching loaderæ‰§è¡Œè¿”å›å€¼äº†,åé¢çš„loader éƒ½ä¸å†æ‰§è¡Œäº†</li> <li>style-loaderå†…éƒ¨çš„å®ç°å°±æ˜¯åˆ©ç”¨pitch,å¦‚ä¸‹å›¾</li></ul> <p><img src="/images/style-loader.jpg" alt=""></p> <h3 id="_7-babel-loader"><a href="#_7-babel-loader" class="header-anchor">#</a> 7. babel-loader</h3> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token comment">//babel-loader.js</span>
 <span class="token keyword">const</span> core <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@babel/core'</span><span class="token punctuation">)</span>
 <span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span>

 <span class="token keyword">function</span> <span class="token function">loader</span><span class="token punctuation">(</span><span class="token parameter">source<span class="token punctuation">,</span>inputSourceMap<span class="token punctuation">,</span>data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">const</span> option <span class="token operator">=</span> <span class="token punctuation">{</span>
     presets<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;@babel/present-env&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
     inputSourceMap<span class="token punctuation">,</span>
     souceMaps<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">//å‘Šè¯‰babelè¦ç”ŸæˆsourceMap</span>
     filename<span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">basename</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>resourcePath<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span>code<span class="token punctuation">,</span>map<span class="token punctuation">,</span>ast<span class="token punctuation">}</span> <span class="token operator">=</span> core<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span>code<span class="token punctuation">,</span>map<span class="token punctuation">,</span>ast<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>

 nodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> loader

 <span class="token comment">//å½“ä½ éœ€è¦è¿”å›å¤šå€¼ çš„æ—¶å€™éœ€è¦ä½¿ç”¨this.callbackä¼ é€’å¤šä¸ªå€¼</span>
 <span class="token comment">//éœ€è¦è¿”å›ä¸€ä¸ªå€¼,å¯ä»¥ç›´æ¥return</span>
 <span class="token comment">//mapå¯ä»¥æµ‹è¯•è°ƒè¯•,debugå¯ä»¥çœ‹åˆ°æºä»£ç </span>
 <span class="token comment">//ast å¦‚æœè¿”å›astç»™webapck,webpackå¯ä»¥ç›´æ¥åˆ†æ,ä¸éœ€è¦è½¬AST</span>
<span class="token comment">// dataå¯ä»¥ç»™loaderç»‘å®šä¸€äº›æ•°æ®çš„</span>

  <span class="token comment">//åœ¨webpack.config.jsé…ç½®</span>

  resolveLoader<span class="token operator">:</span><span class="token punctuation">{</span>
    alias<span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token string">'babel-loader'</span><span class="token operator">:</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./loaders/babel-loader.js'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  rules<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token operator">...</span>
    include<span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/accumulate/guide.html" class="prev">
        ä½¿ç”¨ VuePress æ­å»ºä¸ªäººåšå®¢
      </a></span> <span class="next"><a href="/accumulate/JavaScript.html">
        jsé«˜çº§ç¨‹åºè®¾è®¡
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.74bcc7fa.js" defer></script><script src="/assets/js/2.57345efc.js" defer></script><script src="/assets/js/10.f361683f.js" defer></script>
  </body>
</html>
